<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Blanco">
<meta name="dcterms.date" content="2025-03-12">

<title>unidad_1_q</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="unidad_1_q_files/libs/clipboard/clipboard.min.js"></script>
<script src="unidad_1_q_files/libs/quarto-html/quarto.js"></script>
<script src="unidad_1_q_files/libs/quarto-html/popper.min.js"></script>
<script src="unidad_1_q_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="unidad_1_q_files/libs/quarto-html/anchor.min.js"></script>
<link href="unidad_1_q_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="unidad_1_q_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="unidad_1_q_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="unidad_1_q_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="unidad_1_q_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#unidad-1.-introducción-a-r-y-rstudio" id="toc-unidad-1.-introducción-a-r-y-rstudio" class="nav-link active" data-scroll-target="#unidad-1.-introducción-a-r-y-rstudio">Unidad 1. Introducción a R y RStudio</a>
  <ul class="collapse">
  <li><a href="#el-lenguaje-r" id="toc-el-lenguaje-r" class="nav-link" data-scroll-target="#el-lenguaje-r">El lenguaje R</a></li>
  <li><a href="#ventajas-y-desventajas-de-r" id="toc-ventajas-y-desventajas-de-r" class="nav-link" data-scroll-target="#ventajas-y-desventajas-de-r">Ventajas y desventajas de R</a></li>
  <li><a href="#instalación-de-r" id="toc-instalación-de-r" class="nav-link" data-scroll-target="#instalación-de-r">Instalación de R</a></li>
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio">RStudio</a></li>
  <li><a href="#script-de-trabajo" id="toc-script-de-trabajo" class="nav-link" data-scroll-target="#script-de-trabajo">Script de trabajo</a></li>
  <li><a href="#instalación-y-carga-de-las-librerías" id="toc-instalación-y-carga-de-las-librerías" class="nav-link" data-scroll-target="#instalación-y-carga-de-las-librerías">Instalación y carga de las librerías</a></li>
  <li><a href="#carga-de-nuestros-datos" id="toc-carga-de-nuestros-datos" class="nav-link" data-scroll-target="#carga-de-nuestros-datos">Carga de nuestros datos</a>
  <ul class="collapse">
  <li><a href="#establecer-el-directorio-de-trabajo" id="toc-establecer-el-directorio-de-trabajo" class="nav-link" data-scroll-target="#establecer-el-directorio-de-trabajo">Establecer el directorio de trabajo</a></li>
  <li><a href="#armado-de-la-base-de-datos" id="toc-armado-de-la-base-de-datos" class="nav-link" data-scroll-target="#armado-de-la-base-de-datos">Armado de la base de datos</a></li>
  <li><a href="#cargando-la-base-de-datos" id="toc-cargando-la-base-de-datos" class="nav-link" data-scroll-target="#cargando-la-base-de-datos">Cargando la base de datos</a></li>
  </ul></li>
  <li><a href="#caracterización-de-la-base-de-datos" id="toc-caracterización-de-la-base-de-datos" class="nav-link" data-scroll-target="#caracterización-de-la-base-de-datos">Caracterización de la base de datos</a>
  <ul class="collapse">
  <li><a href="#caracterización-gráfica" id="toc-caracterización-gráfica" class="nav-link" data-scroll-target="#caracterización-gráfica">Caracterización gráfica</a></li>
  </ul></li>
  <li><a href="#manejo-de-la-base-de-datos" id="toc-manejo-de-la-base-de-datos" class="nav-link" data-scroll-target="#manejo-de-la-base-de-datos">Manejo de la base de datos</a>
  <ul class="collapse">
  <li><a href="#subdividir-la-base-de-datos" id="toc-subdividir-la-base-de-datos" class="nav-link" data-scroll-target="#subdividir-la-base-de-datos">Subdividir la base de datos</a></li>
  <li><a href="#seleccionar-filas-o-columnas" id="toc-seleccionar-filas-o-columnas" class="nav-link" data-scroll-target="#seleccionar-filas-o-columnas">Seleccionar filas o columnas</a></li>
  <li><a href="#creación-de-nuevas-variables" id="toc-creación-de-nuevas-variables" class="nav-link" data-scroll-target="#creación-de-nuevas-variables">Creación de nuevas variables</a></li>
  <li><a href="#cambio-en-los-niveles-de-un-factor" id="toc-cambio-en-los-niveles-de-un-factor" class="nav-link" data-scroll-target="#cambio-en-los-niveles-de-un-factor">Cambio en los niveles de un factor</a></li>
  </ul></li>
  <li><a href="#actividad-1" id="toc-actividad-1" class="nav-link" data-scroll-target="#actividad-1">Actividad 1</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">



<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
<div style="page-break-after: always;"></div>
<section id="unidad-1.-introducción-a-r-y-rstudio" class="level1">
<h1>Unidad 1. Introducción a R y RStudio</h1>
<section id="el-lenguaje-r" class="level2">
<h2 class="anchored" data-anchor-id="el-lenguaje-r">El lenguaje R</h2>
<p>R es un lenguaje de escritura propio. Como todo lenguaje, tiene la gran virtud de que permite la comunicación a través de él, se puede intercambiar, podemos “hablarlo” en todas partes del mundo, compartir <em>scripts</em> con colegas y mostrarles cómo analizamos los datos. Sin embargo, su principal virtud es también su kryptonita ya que, como todo lenguaje, tiene muchos modismos. Cada persona desarrolla su propia forma de escritura, arma los <em>scripts</em> como le parece conveniente, entendible, práctico. Uno mismo a lo largo del tiempo va perfeccionando sus propios escritos, corrigiendo lo antes hecho, reescribiendo con un estilo más refinado o más avanzado.</p>
<p>Mi reflexión a este respecto es que la experiencia con el software es dinámica, aquí no se pretende mostrar una receta cerrada que no se puede modificar (ni mucho menos), sino simplemente acercar el programa a aquellos que aún no lo conocen y permitirles dar los primeros pasos para luego iniciar su propio camino.</p>
</section>
<section id="ventajas-y-desventajas-de-r" class="level2">
<h2 class="anchored" data-anchor-id="ventajas-y-desventajas-de-r">Ventajas y desventajas de R</h2>
<p>Por supuesto este apartado es totalmente subjetivo y (al igual que todo este escrito) está enteramente marcado por mi experiencia personal. La principal desventaja salta a la vista: hay que aprender un lenguaje nuevo de escritura. De esta desventaja se desprende su principal limitación: requiere tiempo aprenderlo. El uso de R requiere tener paciencia, leer, aprender a utilizarlo, frustrarse, reintentar, googlear buscando ayuda, etc. Por otra parte, la flexibilidad de escritura a veces dificulta el entendimiento. Finalmente algo que puede parecer una desventaja (que ya veremos que no lo es) es que en algunos casos puede llevarnos bastante tiempo llegar a un gráfico aceptable de acuerdo a nuestro requerimientos, gráfico que a simple vista pareciera haber sido mucho más rápido hacerlo en otro software ya conocido (como excel).</p>
<p>De ahí en más, presenta muchas virtudes:</p>
<ul>
<li>En primer lugar es software libre, al acceso de todos y multiplataforma.</li>
<li>Se usa en investigación en todas partes del mundo, lo que nos permite realizar intercambios con otros investigadores, mandar scripts a nuestros directores, colegas, consultar análisis de otros.</li>
<li>En lo personal, nos facilita seguir paso a paso cómo analizamos nuestros propios datos. Pongamos por caso que luego de 2 años queremos revisar unos datos que ya habíamos analizado y que nos quedaron colgados…acá podemos ver paso a paso todo lo que hicimos (también es cierto que si seguimos avanzando en el programa, nuestra forma de escritura habrá mutado, pero eso no lo hará menos entendible).</li>
<li>Otra ventaja, relacionada a la anterior, es la posibilidad de introducir comentarios en nuestros scripts. Todo lo que aparezca a la derecha del signo <code>#</code> en una línea no formará parte de la corrida. Esto nos permite agregar anotaciones, incluso resultados, hacernos recordatorios, silenciar partes del script que no queramos que se ejecuten, etc.</li>
<li>La esencia de R es la capacidad de repetición. Retomando lo que mencioné como una supuesta desventaja (pero que no lo era), una vez que logramos un gráfico (puede ser también un comando, pero vale el ejemplo) que estéticamente nos agrada, es muy sencillo extrapolar esa apariencia a otro gráfico, aún de diferente tipo. Por lo tanto, todo ese tiempo que nos llevó armarlo, es inversión y aprendizaje para que la siguiente vez todo sea más rápido.</li>
<li>El uso de funciones: relacionado al ítem anterior, y una vez que tengamos algo de manejo, podemos armar las funciones que nosotros queramos reuniendo los análisis que queramos ver y simplificar los comandos para que en una sola línea generemos mucha información.</li>
</ul>
</section>
<section id="instalación-de-r" class="level2">
<h2 class="anchored" data-anchor-id="instalación-de-r">Instalación de R</h2>
<p>En windows, se debe descargar la última versión de R desde su web (<a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a>), e instalarlo como cualquier otro programa.</p>
</section>
<section id="rstudio" class="level2">
<h2 class="anchored" data-anchor-id="rstudio">RStudio</h2>
<p>RStudio es un software que nos va a permitir trabajar de un modo más amigable con R (que de forma nativa se utiliza en un entorno tipo terminal de programación). El programa es de uso libre y se descarga desde la web oficial (<a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a>). Una vez que instalamos el programa y lo abrimos, nos ofrece muchísimas posibilidades. En este taller simplemente vamos a ver su uso básico.</p>
<p>Al abrir el programa lo primero que destaca es que se encuentra dividido en 4 ventanas:</p>
<ol type="1">
<li><p>Ventana 1 - Script de trabajo: arriba a la izquierda. En ella abriremos y editaremos nuestros scripts de trabajo. A medida que se escriben las líneas para ejecutarlas debemos posicionarnos en ella (o seleccionarla) y correrlas (Run, arriba a la derecha, o más fácil <em>Ctrl + r</em>).</p></li>
<li><p>Ventana 2 - consola: se ubica abajo a la izquierda. En ella se nos muestra el R propiamente dicho. Todo lo que nosotros ejecutamos en la ventana 1 se corre en esta segunda ventana, donde se nos muestra el resultado de nuestra corrida. Si se quiere se puede escribir directamente en ella, pero lo que hagamos no quedará guardado en nuestro script de trabajo.</p></li>
<li><p>Ventana 3 - objetos e historial: arriba a la derecha. Aquí podemos visualizar (en la pestaña <em>Environment</em>) todos los objetos, bases de datos, funciones, etc. que hayamos importado o creado. Es muy importante ya que nos permite tener en vista nuestro entorno de trabajo (que es una funcionalidad con la que el R nativo no cuenta, uno debe memorizar los objetos creados). Si se tilda en alguno de los objetos, es equivalente a ejecutar el comando <code>View()</code>, y nos permite visualizar en forma de tabla nuestras bases de datos (se abren en la ventana 1). Contamos aquí con una opción gráfica para importar nuestras bases de datos, pero en este curso lo haremos directamente con código. También contamos con una escoba que nos permite borrar todos los objetos que tengamos. La segunda pestaña <em>History</em> nos permite precisamente ver el historial de corridas que hayamos hecho. Allí podemos revisar comandos que ya ejecutamos y queremos repetir.</p></li>
<li><p>Ventana 4 - gráficos, paquetes y ayuda: abajo a la derecha. Usaremos 3 de las pestañas:</p></li>
</ol>
<ul>
<li><em>Plots</em>: aquí visualizaremos todos los gráficos que vayamos generando. Nos permite mediante las flechas de arriba a la izquierda ir viendo también los gráficos anteriores. El icono Zoom nos facilita la visualización externa del gráfico que estemos viendo. Además presenta opciones de exportación.</li>
<li><em>Packages</em>: aquí podemos visualizar la lista completa de paquetes que tenemos instalados. Si tildamos uno lo activamos (equivalente al comando <code>library</code>, ver más adelante). Si tildamos en <em>Install</em> podemos agregar nuevos paquetes que estén en el CRAN (base de datos de librerías).</li>
<li><em>Help</em>: como bien dice el nombre es la ventana de ayuda. Súper útil y de consulta constante. Allí podemos ver las descripciones que escribieron los creadores de cada función y/o paquete que usemos.</li>
</ul>
<p>Como se ve RStudio nos permite realizar diversas acciones de forma gráfica, sin necesidad de utilizar código. Mi postura en general es dejar escrito en nuestro script la mayor cantidad de pasos posibles, ya que todo lo que hagamos de forma gráfica no nos queda disponible cuando volvamos a ver nuestro archivo. En este sentido, la instalación de paquetes o las búsquedas de ayuda no es algo que necesitemos en un futuro en nuestro script y podemos hacerlo de forma gráfica. Pero, contrariamente, la carga de la base de datos, paquetes, exportación de figuras, nos resultará de utilidad dejarlo plasmado en el escrito.</p>
<p>RStudio incluye un infinidad de opciones extra que no hacen al objetivo de este curso. Para usos más avanzados es recomendable revisar la página web de los creadores, que es muy completa e incluye muchas utilidades y tutoriales. También se encuentra mucha ayuda en la pestaña Help.</p>
</section>
<section id="script-de-trabajo" class="level2">
<h2 class="anchored" data-anchor-id="script-de-trabajo">Script de trabajo</h2>
<p>En este apartado comenzaremos propiamente a desarrollar un script de trabajo. Iremos viendo paso a paso como avanzar en su armado, desde la carga de las librerías, introducir la base de datos y el manejo de la misma, el análisis de los datos hasta la visualización gráfica de los mismos.</p>
<p>Lo primero que hay que hacer un vez ingresados en RStudio es crear un nuevo script (File -&gt; New File -&gt; R Script). Allí nosotros podremos ir desarrollando los comandos correspondientes.</p>
<p>Todo script de trabajo tiene una estructura similar, la que yo utilizo es:</p>
<ul>
<li>Carga de las librerías.</li>
<li>Carga de la base de datos.</li>
<li>Creación de las databases necesarias.</li>
<li>Armado de las funciones necesarias (si es que las tuviéramos).</li>
<li>Análisis de los datos separados por títulos.</li>
</ul>
<p>Los títulos son marcas que hacemos para volver sencillamente a otras partes de nuestro script (tengamos en cuenta que fácilmente se superan las 1000 líneas). Para introducir un título (o marcador) colocamos la palabra clave como un comentario y agregamos una serie de signos - a la derecha. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías ------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir de este momento podemos ver nuestros títulos en 2 lugares: en la parte inferior izquierda de la ventana 1 o en la parte superior derecha de la misma ventana en el icono con la leyenda <em>Outline</em>. Esta estructuración, insisto, es muy útil para movernos dentro del documento sin perder mucho tiempo buscando algún comando. A su vez, si introducimos más # al comienzo, se generan títulos de un nivel inferior.</p>
</section>
<section id="instalación-y-carga-de-las-librerías" class="level2">
<h2 class="anchored" data-anchor-id="instalación-y-carga-de-las-librerías">Instalación y carga de las librerías</h2>
<p>R se maneja en base a paquetes (o librerías) que contienen las funciones que queramos utilizar. Como base R trae pre-instalados una serie de paquetes que nos sirven para realizar gran cantidad de aplicaciones. Sin embargo, es muy usual que prefiramos usar otras funciones no disponibles en la base.</p>
<p>Para instalar una librería debemos ejecutar el código</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nombre del paquete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La instalación de paquetes debemos realizarla una única vez. Como se mencionó al describir la Ventana 4, también podemos instalar los paquetes de un modo gráfico en la pestaña Packages de RStudio.</p>
<p>Cada vez que ingresamos a RStudio debemos cargar nuestras librerías a utilizar. Para cargar una librería utilizamos el código</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nombre del paquete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos cargar varios paquetes, podemos ejecutar varios comandos library en una misma línea separándolos con “;”, y así cargar todos en una única línea de corrida (Ctrl + r). Por otro lado, si bien uno puede tener un conjunto de paquetes que utiliza habitualmente, no es recomendable cargar de más ya que muchas veces se solapan funciones y podemos tener alguna complicación.</p>
<p>Para el uso de este taller, instalaremos los paquetes <strong>agricolae</strong>, <strong>car</strong>, <strong>sciplot</strong>, <strong>patchwork</strong>, <strong>gridExtra</strong> , <strong>viridis</strong> y <strong>tidyverse</strong>. Este último incluye una serie de paquetes en su interior, que abarcan desde funcionalidades gráficas hasta opciones del manejo de datos.</p>
<p>Así podemos cargarlos todos de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae);<span class="fu">library</span>(tidyverse);<span class="fu">library</span>(car)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sciplot);<span class="fu">library</span>(patchwork); <span class="fu">library</span>(gridExtra)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="carga-de-nuestros-datos" class="level2">
<h2 class="anchored" data-anchor-id="carga-de-nuestros-datos">Carga de nuestros datos</h2>
<p>Como para casi cualquier acción que queramos ejecutar en R, la carga de la base de datos puede hacerse de muchas maneras. En la ventana 3 se nos ofrece una opción gráfica (a través de “Import Dataset”).</p>
<p>De todas maneras, es recomendable hacerlo mediante código, para que cada vez que ingresemos podamos incorporar la base de datos de manera muy sencilla.</p>
<section id="establecer-el-directorio-de-trabajo" class="level3">
<h3 class="anchored" data-anchor-id="establecer-el-directorio-de-trabajo">Establecer el directorio de trabajo</h3>
<p>Lo primero que debemos hacer es establecer el directorio de trabajo. Para ello corremos el comando (con un directorio ejemplo):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"D:/DATOS/R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos revisar en qué directorio nos encontramos, ejecutamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "D:/Documents/OneDrive/R/Taller R 2025 Doctorado/curso_graficos_ggplot/unidad_1"</code></pre>
</div>
</div>
<p>Ahora antes de ver cómo cargar la base de datos, haremos una breve explicación de como crear la base de datos.</p>
</section>
<section id="armado-de-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="armado-de-la-base-de-datos">Armado de la base de datos</h3>
<p>Una vez más, aquí mostraré mi forma de armar las bases de datos, hay muchas..</p>
<p>La forma de la base de datos es la misma que se utiliza en otros software como Infostat. Debemos crear una columna por cada factor o variable que tengamos, y repetir el nivel del factor para cada unidad experimental (cada fila).</p>
<p>El formato en el que yo creo mis bases de datos es csv (archivo separado por comas). Para ello se exporta desde excel o calc el archivo en ese formato. El documento debe tener una única hoja con las base de datos limpia, es decir sin columnas o filas extras con comentarios, datos extra, etc. Por otro lado, es recomendable que los nombres de las columnas sean lo más cortos posibles, y que no tengan espacios. Otra recomendación es omitir el uso de tildes u otros caracteres especiales en cualquier parte del documento puede llegar a tener problemas según la codificación que usemos en RStudio. La más compatible es la UTF-8, que no suele generar problemas.</p>
<p>Resumiendo, la recomendación es que una vez que tenemos nuestra tabla (en excel por ejemplo) con los datos listos, copiarla y pegarla en un documento nuevo. Allí ver de simplificar los nombres de las columnas, también de los niveles de factores a utilizar. Guardar este nuevo documento como csv, si estamos en idioma español establecer para la separación de columnas “;”. Por supuesto, guardamos el archivo en el directorio de trabajo.</p>
<p>Para este curso utilizaremos inicialmente la base de datos “metals.csv”.</p>
</section>
<section id="cargando-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargando-la-base-de-datos">Cargando la base de datos</h3>
<p>En este aparto, cabe destacar que R es un lenguaje orientado a objetos. Cargaremos nuestra base de datos como un “objeto” de R, al cual debemos asignarle un nombre. De ahí en más, cualquier acción que modifique nuestro “objeto” quedará guardada en el objeto mismo, pero no modificará nuestro archivo original (el csv en este caso). Para crear un objeto lo asignamos con “&lt;-” (de forma rápida se escribe con Alt + -) o con el signo “=”.</p>
<p>Una primera forma de cargarla es mediante la función read.csv, por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"metales.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como la base está en español, no se carga correctamente. Debemos corregir un par de parámetros:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"metales.csv"</span>, <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(metales, class) <span class="co"># vemos que crea factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pote
[1] "integer"

$GT
[1] "character"

$CO2
[1] "integer"

$ET
[1] "character"

$Organo
[1] "character"

$PS
[1] "numeric"

$Mn
[1] "numeric"

$Cu
[1] "numeric"

$Zn
[1] "numeric"

$Cd
[1] "numeric"

$Pb
[1] "numeric"

$SPAD
[1] "numeric"</code></pre>
</div>
</div>
<p>La función que yo más utilizo es la que viene con el paquete tidyverse, llamada <code>read_csv</code>. Si usamos <code>read_csv2</code>, toma la coma como separador decimal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"metales.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 142 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (3): GT, ET, Organo
dbl (9): Pote, CO2, PS, Mn, Cu, Zn, Cd, Pb, SPAD

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Vemos que en este caso nos mostró directamente la clase de cada columna, y que crea objetos tipo character en vez de factor.</p>
<p>En la ventana 3, nos aparecerán los objetos que incorporemos.</p>
</section>
</section>
<section id="caracterización-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="caracterización-de-la-base-de-datos">Caracterización de la base de datos</h2>
<p>Para ver primeros datos y los nombres de las columnas ejecutamos los comandos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
   Pote GT          CO2 ET    Organo    PS    Mn    Cu    Zn    Cd    Pb  SPAD
  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1 ES Mentor   400 No    Hoja    4.58  53.9 10.3  103.  1.30   7.22  29.5
2     2 ES Mentor   400 No    Hoja    3.61  51.1  7.36 149.  1.09   2.75  21.5
3     3 ES Mentor   400 No    Hoja    4.27  41.7  6.90  96.9 0.956  2.53  24.7
4     4 ES Mentor   400 Si    Hoja    4.62  54.0  8.77 119.  0.901  3.05  22.6
5     5 ES Mentor   400 Si    Hoja    4.68  51.2  6.64 108.  1.16   3.21  25.6
6     6 ES Mentor   400 Si    Hoja    4.38  50.3  8.16 111.  0.682  3.69  22.8</code></pre>
</div>
</div>
<p>Para ver la tabla completa, se debe tildar en el nombre del objeto en la ventana 3. Aprovechando que tenemos la tabla a nuestra vista, daré aquí una breve descripción de los datos. La tabla cargada cuenta con datos de plantas de soja de 3 cultivares (o genotipos) diferentes: Alim 3,14, ES Mentor y Sigalia (todos en la columna GT). Estas plantas crecieron en cámaras climáticas con condiciones controladas de luz, temperatura, humedad y concentración de CO<sub>2</sub>. Las siguientes columnas de la base de datos son las siguientes:</p>
<ul>
<li><p>CO<sub>2</sub>: es la concentración en la cual crecieron las plantas. Tiene dos niveles: 400 ppm y 550 ppm.</p></li>
<li><p>ET: estrés térmico. Algunas de las plantas fueron sometidas a estrés térmico en el periodo crítico de llenado de grano. Tiene dos niveles: Sí o No.</p></li>
<li><p>Órgano: refiere a si se trata de raíces, tallos, hojas, vainas o semillas.</p></li>
<li><p>PS: peso seco del órgano correspondiente.</p></li>
<li><p>Mn, Cu, Zn, Pb, Cd: concentración del metal en el órgano correspondiente en ppm.</p></li>
<li><p>SPAD: medición promedio de SPAD (verdor) en hojas a lo largo del desarrollo. Valor sólo válido para las hojas.</p></li>
</ul>
<p>Además podemos ver un resumen de nuestra base o hacerle “preguntas” a R sobre la base de datos. Al escribir “$” a continuación de un objeto podemos ver las columnas individuales. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(metales) <span class="co"># resumen de la base</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Pote            GT                 CO2           ET           
 Min.   : 1.00   Length:142         Min.   :400   Length:142        
 1st Qu.:10.00   Class :character   1st Qu.:400   Class :character  
 Median :18.50   Mode  :character   Median :475   Mode  :character  
 Mean   :18.46                      Mean   :475                     
 3rd Qu.:27.00                      3rd Qu.:550                     
 Max.   :36.00                      Max.   :550                     
    Organo                PS               Mn               Cu        
 Length:142         Min.   : 1.030   Min.   : 2.122   Min.   : 2.568  
 Class :character   1st Qu.: 1.875   1st Qu.: 7.952   1st Qu.: 5.899  
 Mode  :character   Median : 2.720   Median :20.450   Median : 7.272  
                    Mean   : 3.561   Mean   :24.086   Mean   :10.582  
                    3rd Qu.: 4.215   3rd Qu.:34.296   3rd Qu.:12.472  
                    Max.   :12.330   Max.   :83.826   Max.   :38.300  
       Zn               Cd              Pb               SPAD      
 Min.   : 13.41   Min.   :0.623   Min.   : 0.0340   Min.   :20.27  
 1st Qu.: 43.06   1st Qu.:0.961   1st Qu.: 0.1308   1st Qu.:23.09  
 Median : 80.55   Median :1.207   Median : 2.1740   Median :25.84  
 Mean   : 91.42   Mean   :1.336   Mean   : 2.7108   Mean   :25.76  
 3rd Qu.:103.41   3rd Qu.:1.667   3rd Qu.: 4.4465   3rd Qu.:27.69  
 Max.   :345.52   Max.   :2.849   Max.   :11.6470   Max.   :32.24  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.double</span>(metales<span class="sc">$</span>PS) <span class="co"># double indica numérico continuo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(metales<span class="sc">$</span>GT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(metales<span class="sc">$</span>GT)) <span class="co"># para ver los niveles de un factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alim 3,14" "ES Mentor" "Sigalia"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(metales<span class="sc">$</span>Organo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hoja"    "Semilla" "Tallo"   "Vaina"  </code></pre>
</div>
</div>
<section id="caracterización-gráfica" class="level3">
<h3 class="anchored" data-anchor-id="caracterización-gráfica">Caracterización gráfica</h3>
<p>En este caso haremos algunos gráficos sencillos para observar la distribución de nuestra base de datos. La función <code>plot</code> (y sus derivados, como en este caso <code>boxplot</code>) viene con R base y es la forma más rápida y sencilla de graficar.</p>
<div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(metales<span class="sc">$</span>PS<span class="sc">~</span>metales<span class="sc">$</span>Organo)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(metales<span class="sc">$</span>Pb<span class="sc">~</span>metales<span class="sc">$</span>GT)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(metales<span class="sc">$</span>Cd)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(metales<span class="sc">$</span>Pb<span class="sc">~</span>metales<span class="sc">$</span>Cd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="unidad_1_q_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="unidad_1_q_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="unidad_1_q_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="unidad_1_q_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manejo-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="manejo-de-la-base-de-datos">Manejo de la base de datos</h2>
<section id="subdividir-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="subdividir-la-base-de-datos">Subdividir la base de datos</h3>
<p>Algo muy común en el trabajo en R, es la necesidad de subdividir la base de datos para utilizar únicamente una parte de ella. Veremos un par de formas de hacerlo.</p>
<p>Con las funciones que incluye R base, utilizaremos <code>subset</code>. Por ejemplo para elegir solo las muestras del genotipo <em>Alim 3,14</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="ot">&lt;-</span> <span class="fu">subset</span>(metales, metales<span class="sc">$</span>GT<span class="sc">==</span><span class="st">"Alim 3,14"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y creamos un objeto que se llama <em>ALIM</em>, nuevamente mediante <em>&lt;-</em>.</p>
<p>Otra forma de hacerlo es mediante el uso de pipes (%&gt;%). Las pipes sirven para concatenar una serie de acciones para modificar una base de datos. En primer lugar se ubica la base a modificar y entre cada linea de comando %&gt;% (<em>Ctrl + Shift + m</em>). Así, podemos crear la misma base de antes con <code>filter</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GT <span class="sc">==</span> <span class="st">"Alim 3,14"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos filtrar por más de un parámetro:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en dos pasos</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ALIM_VyS <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(GT <span class="sc">==</span> <span class="st">"Alim 3,14"</span>) <span class="sc">%&gt;%</span> <span class="co"># se agrega a lo anterior</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Organo <span class="sc">==</span><span class="st">"Vaina"</span><span class="sc">|</span> Organo <span class="sc">==</span><span class="st">"Semilla"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="seleccionar-filas-o-columnas" class="level3">
<h3 class="anchored" data-anchor-id="seleccionar-filas-o-columnas">Seleccionar filas o columnas</h3>
<p>En R base, el uso de [ ] sirve para seleccionar filas o columnas de una database, tal que <code>data[filas,columnas]</code>. En el entorno de <em>dplyr</em> utilizaremos la función <code>select</code> para columnas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar filas 1 a 3</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>metales[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 12
   Pote GT          CO2 ET    Organo    PS    Mn    Cu    Zn    Cd    Pb  SPAD
  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1 ES Mentor   400 No    Hoja    4.58  53.9 10.3  103.  1.30   7.22  29.5
2     2 ES Mentor   400 No    Hoja    3.61  51.1  7.36 149.  1.09   2.75  21.5
3     3 ES Mentor   400 No    Hoja    4.27  41.7  6.90  96.9 0.956  2.53  24.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar columnas 1 a 3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>metales[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
    Pote GT          CO2
   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1     1 ES Mentor   400
 2     2 ES Mentor   400
 3     3 ES Mentor   400
 4     4 ES Mentor   400
 5     5 ES Mentor   400
 6     6 ES Mentor   400
 7     7 Sigalia     400
 8     8 Sigalia     400
 9     9 Sigalia     400
10    10 Sigalia     400
# ℹ 132 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>metales <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
    Pote GT          CO2
   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1     1 ES Mentor   400
 2     2 ES Mentor   400
 3     3 ES Mentor   400
 4     4 ES Mentor   400
 5     5 ES Mentor   400
 6     6 ES Mentor   400
 7     7 Sigalia     400
 8     8 Sigalia     400
 9     9 Sigalia     400
10    10 Sigalia     400
# ℹ 132 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar por nombre de la columna</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>metales <span class="sc">%&gt;%</span> <span class="fu">select</span>(GT,CO2,Pb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
   GT          CO2    Pb
   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 ES Mentor   400  7.22
 2 ES Mentor   400  2.75
 3 ES Mentor   400  2.53
 4 ES Mentor   400  3.05
 5 ES Mentor   400  3.21
 6 ES Mentor   400  3.69
 7 Sigalia     400  4.93
 8 Sigalia     400  6.89
 9 Sigalia     400  6.45
10 Sigalia     400  4.06
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section id="creación-de-nuevas-variables" class="level3">
<h3 class="anchored" data-anchor-id="creación-de-nuevas-variables">Creación de nuevas variables</h3>
<p>Una opción muy útil ligada al paquete <strong>dplyr</strong> es la de transformar nuestras bases de datos para algún gráfico en particular, sin necesidad de cambiar la tabla original. Para ello utilizaremos la función <code>mutate</code>, que permite generar muchos cambios en la base de datos. Por ejemplo, en la base ALIM, si queremos agregar la cantidad absoluta de Pb extraída:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Pb_total"</span> <span class="ot">=</span> Pb<span class="sc">*</span>PS) <span class="co"># se crea una nueva columna</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># para ver la columna nueva</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>metales<span class="sc">$</span>Pb_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  33.06302   9.91306  10.79029  14.08638  15.00876  16.17096  20.29512
  [8]  27.08556  26.89233  16.41048  21.13308  13.07837  90.21291  47.62605
 [15]  34.42750  32.72702 104.37124  60.83160  11.97888  18.05868  11.41854
 [22]   9.45945  26.60670  14.74590  15.39456  10.70520  26.29791  21.00659
 [29]  29.45446  26.90309  56.83056  71.08245  28.40670  20.39830  22.12022
 [36]  15.66058   0.53040   0.21148   0.35308   0.12864   0.18957   0.15876
 [43]   0.34568   0.16218   0.26832   0.16653   0.13771   0.20181   1.30689
 [50]   0.26668   0.24779   0.06052   0.11200   0.13858   0.17000   0.09720
 [57]   0.11232   0.15456   0.21060   0.17806   0.13260   0.18768   0.31376
 [64]   0.43420   0.10500   0.19250   1.15430   1.39783   0.68175   0.09020
 [71]   0.12669   0.09306  19.56636  12.97743  15.53136   8.62628  22.82812
 [78]   6.70020  11.51128   8.49915  10.31240  12.42600   6.58415   3.86750
 [85]  40.15790  17.30625   7.66112  11.69561  13.83342  14.11765   3.68520
 [92]   3.53430   3.21594   5.76495   5.95000   3.79984   8.42044   9.41645
 [99]  11.57807  12.14784   6.73466   7.59570  48.02186  35.38976  33.43392
[106]  22.93984  10.68801   1.87756   0.12788   0.41223   3.65980   1.99801
[113]   0.22490   1.61504   2.01480   4.27158   1.36136   0.36025   8.40807
[120]   1.19240   0.75150   1.33900   1.48086   1.53242   0.71118   0.96642
[127]   0.95130   1.18125   2.77965   2.02789   2.81808   2.32225   0.66102
[134]   1.00975   1.17260   0.57710  12.66513  25.29600  14.93736   7.39102
[141]   0.57288   1.09347</code></pre>
</div>
</div>
</section>
<section id="cambio-en-los-niveles-de-un-factor" class="level3">
<h3 class="anchored" data-anchor-id="cambio-en-los-niveles-de-un-factor">Cambio en los niveles de un factor</h3>
<p>También podemos cambiar los niveles de una factor <code>mutate</code>, mediante la siguiente estructura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>... <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nombre_factor =</span> <span class="fu">fct_recode</span>(nombre_factor,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nombre nuevo"</span> <span class="ot">=</span> <span class="st">"nombre viejo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y podemos incluir una línea para cada nivel que queramos modificar. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="sc">%&gt;%</span> <span class="fu">select</span>(CO2, ET, PS) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ET =</span> <span class="fu">fct_recode</span>(ET,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Control"</span>  <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Estrés térmico"</span> <span class="ot">=</span> <span class="st">"Si"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 47 × 3
     CO2 ET                PS
   &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;
 1   400 Control        10.7 
 2   400 Control         8.29
 3   400 Control         5.86
 4   400 Estrés térmico  7.46
 5   400 Estrés térmico  9.43
 6   400 Estrés térmico  8.15
 7   550 Control        11.8 
 8   550 Control        12.3 
 9   550 Control         9.45
10   550 Estrés térmico  8.45
# ℹ 37 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="actividad-1" class="level2">
<h2 class="anchored" data-anchor-id="actividad-1">Actividad 1</h2>
<ol type="1">
<li>Cree a partir de la base de datos original, una que contenga únicamente los tallos y hojas del cultivar ES Mentor, y las columnas de CO<sub>2</sub>, ET, Organo, PS, Zn y Pb.</li>
<li>Filtre la base creada para obtener otra que solo tenga aquellos datos con más de 3 ppm de Pb.</li>
</ol>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>