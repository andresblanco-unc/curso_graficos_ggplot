<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Blanco">
<meta name="dcterms.date" content="2024-12-31">

<title>Gráficos para publicaciones en R con énfasis en ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="curso_R_2025_q_files/libs/clipboard/clipboard.min.js"></script>
<script src="curso_R_2025_q_files/libs/quarto-html/quarto.js"></script>
<script src="curso_R_2025_q_files/libs/quarto-html/popper.min.js"></script>
<script src="curso_R_2025_q_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="curso_R_2025_q_files/libs/quarto-html/anchor.min.js"></script>
<link href="curso_R_2025_q_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="curso_R_2025_q_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="curso_R_2025_q_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="curso_R_2025_q_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="curso_R_2025_q_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link active" data-scroll-target="#objetivos">Objetivos</a></li>
  <li><a href="#contenidos" id="toc-contenidos" class="nav-link" data-scroll-target="#contenidos">Contenidos</a></li>
  <li><a href="#introducción-a-r-y-rstudio" id="toc-introducción-a-r-y-rstudio" class="nav-link" data-scroll-target="#introducción-a-r-y-rstudio"><span class="header-section-number">1</span> Introducción a R y RStudio</a>
  <ul class="collapse">
  <li><a href="#el-lenguaje-r" id="toc-el-lenguaje-r" class="nav-link" data-scroll-target="#el-lenguaje-r"><span class="header-section-number">1.1</span> El lenguaje R</a></li>
  <li><a href="#ventajas-y-desventajas-de-r" id="toc-ventajas-y-desventajas-de-r" class="nav-link" data-scroll-target="#ventajas-y-desventajas-de-r"><span class="header-section-number">1.2</span> Ventajas y desventajas de R</a></li>
  <li><a href="#instalación-de-r" id="toc-instalación-de-r" class="nav-link" data-scroll-target="#instalación-de-r"><span class="header-section-number">1.3</span> Instalación de R</a></li>
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio"><span class="header-section-number">1.4</span> RStudio</a></li>
  <li><a href="#script-de-trabajo" id="toc-script-de-trabajo" class="nav-link" data-scroll-target="#script-de-trabajo"><span class="header-section-number">1.5</span> Script de trabajo</a></li>
  <li><a href="#instalación-y-carga-de-las-librerías" id="toc-instalación-y-carga-de-las-librerías" class="nav-link" data-scroll-target="#instalación-y-carga-de-las-librerías"><span class="header-section-number">1.6</span> Instalación y carga de las librerías</a></li>
  <li><a href="#carga-de-nuestros-datos" id="toc-carga-de-nuestros-datos" class="nav-link" data-scroll-target="#carga-de-nuestros-datos"><span class="header-section-number">1.7</span> Carga de nuestros datos</a>
  <ul class="collapse">
  <li><a href="#establecer-el-directorio-de-trabajo" id="toc-establecer-el-directorio-de-trabajo" class="nav-link" data-scroll-target="#establecer-el-directorio-de-trabajo"><span class="header-section-number">1.7.1</span> Establecer el directorio de trabajo</a></li>
  <li><a href="#armado-de-la-base-de-datos" id="toc-armado-de-la-base-de-datos" class="nav-link" data-scroll-target="#armado-de-la-base-de-datos"><span class="header-section-number">1.7.2</span> Armado de la base de datos</a></li>
  <li><a href="#cargando-la-base-de-datos" id="toc-cargando-la-base-de-datos" class="nav-link" data-scroll-target="#cargando-la-base-de-datos"><span class="header-section-number">1.7.3</span> Cargando la base de datos</a></li>
  </ul></li>
  <li><a href="#caracterización-de-la-base-de-datos" id="toc-caracterización-de-la-base-de-datos" class="nav-link" data-scroll-target="#caracterización-de-la-base-de-datos"><span class="header-section-number">1.8</span> Caracterización de la base de datos</a>
  <ul class="collapse">
  <li><a href="#caracterización-gráfica" id="toc-caracterización-gráfica" class="nav-link" data-scroll-target="#caracterización-gráfica"><span class="header-section-number">1.8.1</span> Caracterización gráfica</a></li>
  </ul></li>
  <li><a href="#manejo-de-la-base-de-datos" id="toc-manejo-de-la-base-de-datos" class="nav-link" data-scroll-target="#manejo-de-la-base-de-datos"><span class="header-section-number">1.9</span> Manejo de la base de datos</a>
  <ul class="collapse">
  <li><a href="#subdividir-la-base-de-datos" id="toc-subdividir-la-base-de-datos" class="nav-link" data-scroll-target="#subdividir-la-base-de-datos"><span class="header-section-number">1.9.1</span> Subdividir la base de datos</a></li>
  <li><a href="#seleccionar-filas-o-columnas" id="toc-seleccionar-filas-o-columnas" class="nav-link" data-scroll-target="#seleccionar-filas-o-columnas"><span class="header-section-number">1.9.2</span> Seleccionar filas o columnas</a></li>
  <li><a href="#creación-de-nuevas-variables" id="toc-creación-de-nuevas-variables" class="nav-link" data-scroll-target="#creación-de-nuevas-variables"><span class="header-section-number">1.9.3</span> Creación de nuevas variables</a></li>
  <li><a href="#cambio-en-los-niveles-de-un-factor" id="toc-cambio-en-los-niveles-de-un-factor" class="nav-link" data-scroll-target="#cambio-en-los-niveles-de-un-factor"><span class="header-section-number">1.9.4</span> Cambio en los niveles de un factor</a></li>
  </ul></li>
  <li><a href="#actividad-1" id="toc-actividad-1" class="nav-link" data-scroll-target="#actividad-1"><span class="header-section-number">1.10</span> Actividad 1</a></li>
  </ul></li>
  <li><a href="#unidad-2.-análisis-y-representación-de-datos-numéricos" id="toc-unidad-2.-análisis-y-representación-de-datos-numéricos" class="nav-link" data-scroll-target="#unidad-2.-análisis-y-representación-de-datos-numéricos"><span class="header-section-number">2</span> Unidad 2. Análisis y representación de datos numéricos</a>
  <ul class="collapse">
  <li><a href="#correlación" id="toc-correlación" class="nav-link" data-scroll-target="#correlación"><span class="header-section-number">2.1</span> Correlación</a>
  <ul class="collapse">
  <li><a href="#análisis-de-normalidad" id="toc-análisis-de-normalidad" class="nav-link" data-scroll-target="#análisis-de-normalidad"><span class="header-section-number">2.1.1</span> Análisis de normalidad</a></li>
  <li><a href="#muchas-columnas-a-la-vez" id="toc-muchas-columnas-a-la-vez" class="nav-link" data-scroll-target="#muchas-columnas-a-la-vez"><span class="header-section-number">2.1.2</span> Muchas columnas a la vez</a></li>
  </ul></li>
  <li><a href="#regresión-lineal-simple" id="toc-regresión-lineal-simple" class="nav-link" data-scroll-target="#regresión-lineal-simple"><span class="header-section-number">2.2</span> Regresión lineal simple</a></li>
  <li><a href="#actividad-2" id="toc-actividad-2" class="nav-link" data-scroll-target="#actividad-2"><span class="header-section-number">2.3</span> Actividad 2</a></li>
  <li><a href="#gráficos-de-puntos" id="toc-gráficos-de-puntos" class="nav-link" data-scroll-target="#gráficos-de-puntos"><span class="header-section-number">2.4</span> Gráficos de puntos</a>
  <ul class="collapse">
  <li><a href="#función-plot" id="toc-función-plot" class="nav-link" data-scroll-target="#función-plot"><span class="header-section-number">2.4.1</span> Función plot</a></li>
  <li><a href="#función-lineplot.ci-paquete-sciplot" id="toc-función-lineplot.ci-paquete-sciplot" class="nav-link" data-scroll-target="#función-lineplot.ci-paquete-sciplot"><span class="header-section-number">2.4.2</span> Función lineplot.CI (paquete sciplot)</a></li>
  <li><a href="#función-ggplot-paquete-ggplot2" id="toc-función-ggplot-paquete-ggplot2" class="nav-link" data-scroll-target="#función-ggplot-paquete-ggplot2"><span class="header-section-number">2.4.3</span> Función ggplot (paquete ggplot2)</a></li>
  <li><a href="#actividad-3" id="toc-actividad-3" class="nav-link" data-scroll-target="#actividad-3"><span class="header-section-number">2.4.4</span> Actividad 3</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#unidad-3.-análisis-y-representación-de-datos-categóricos" id="toc-unidad-3.-análisis-y-representación-de-datos-categóricos" class="nav-link" data-scroll-target="#unidad-3.-análisis-y-representación-de-datos-categóricos"><span class="header-section-number">3</span> Unidad 3. Análisis y representación de datos categóricos</a>
  <ul class="collapse">
  <li><a href="#anova-a-1-factor" id="toc-anova-a-1-factor" class="nav-link" data-scroll-target="#anova-a-1-factor"><span class="header-section-number">3.1</span> ANOVA a 1 factor</a></li>
  <li><a href="#anova-bifactorial" id="toc-anova-bifactorial" class="nav-link" data-scroll-target="#anova-bifactorial"><span class="header-section-number">3.2</span> ANOVA bifactorial</a></li>
  <li><a href="#actividad-4" id="toc-actividad-4" class="nav-link" data-scroll-target="#actividad-4"><span class="header-section-number">3.3</span> Actividad 4</a></li>
  <li><a href="#gráficos-de-barras" id="toc-gráficos-de-barras" class="nav-link" data-scroll-target="#gráficos-de-barras"><span class="header-section-number">3.4</span> Gráficos de barras</a>
  <ul class="collapse">
  <li><a href="#bargraph.ci-sciplot" id="toc-bargraph.ci-sciplot" class="nav-link" data-scroll-target="#bargraph.ci-sciplot"><span class="header-section-number">3.4.1</span> bargraph.CI (sciplot)</a></li>
  <li><a href="#geom_col-ggplot2" id="toc-geom_col-ggplot2" class="nav-link" data-scroll-target="#geom_col-ggplot2"><span class="header-section-number">3.4.2</span> geom_col (ggplot2)</a></li>
  <li><a href="#gráfico-de-barras-apiladas-y-apilado-porcentual" id="toc-gráfico-de-barras-apiladas-y-apilado-porcentual" class="nav-link" data-scroll-target="#gráfico-de-barras-apiladas-y-apilado-porcentual"><span class="header-section-number">3.4.3</span> Gráfico de barras apiladas y apilado porcentual</a></li>
  </ul></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">3.5</span> Boxplot</a>
  <ul class="collapse">
  <li><a href="#función-boxplot" id="toc-función-boxplot" class="nav-link" data-scroll-target="#función-boxplot"><span class="header-section-number">3.5.1</span> Función boxplot</a></li>
  <li><a href="#geom_boxplot" id="toc-geom_boxplot" class="nav-link" data-scroll-target="#geom_boxplot"><span class="header-section-number">3.5.2</span> geom_boxplot</a></li>
  </ul></li>
  <li><a href="#actividad-5" id="toc-actividad-5" class="nav-link" data-scroll-target="#actividad-5"><span class="header-section-number">3.6</span> Actividad 5</a></li>
  </ul></li>
  <li><a href="#unidad-4.-estructura-y-estética-de-gráficos-con-ggplot2." id="toc-unidad-4.-estructura-y-estética-de-gráficos-con-ggplot2." class="nav-link" data-scroll-target="#unidad-4.-estructura-y-estética-de-gráficos-con-ggplot2."><span class="header-section-number">4</span> Unidad 4. Estructura y estética de gráficos con ggplot2.</a>
  <ul class="collapse">
  <li><a href="#exportación-de-resultados-y-gráficos" id="toc-exportación-de-resultados-y-gráficos" class="nav-link" data-scroll-target="#exportación-de-resultados-y-gráficos"><span class="header-section-number">4.1</span> Exportación de resultados y gráficos</a>
  <ul class="collapse">
  <li><a href="#exportación-de-datos" id="toc-exportación-de-datos" class="nav-link" data-scroll-target="#exportación-de-datos"><span class="header-section-number">4.1.1</span> Exportación de datos</a></li>
  <li><a href="#exportación-de-gráficos" id="toc-exportación-de-gráficos" class="nav-link" data-scroll-target="#exportación-de-gráficos"><span class="header-section-number">4.1.2</span> Exportación de gráficos</a></li>
  </ul></li>
  <li><a href="#títulos" id="toc-títulos" class="nav-link" data-scroll-target="#títulos"><span class="header-section-number">4.2</span> Títulos</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"><span class="header-section-number">4.3</span> Scales</a>
  <ul class="collapse">
  <li><a href="#manipulando-los-ejes" id="toc-manipulando-los-ejes" class="nav-link" data-scroll-target="#manipulando-los-ejes"><span class="header-section-number">4.3.1</span> Manipulando los ejes</a></li>
  <li><a href="#colores" id="toc-colores" class="nav-link" data-scroll-target="#colores"><span class="header-section-number">4.3.2</span> Colores</a></li>
  <li><a href="#forma-y-tipo-de-línea" id="toc-forma-y-tipo-de-línea" class="nav-link" data-scroll-target="#forma-y-tipo-de-línea"><span class="header-section-number">4.3.3</span> Forma y tipo de línea</a></li>
  </ul></li>
  <li><a href="#subdivisión-del-gráfico-con-faceting" id="toc-subdivisión-del-gráfico-con-faceting" class="nav-link" data-scroll-target="#subdivisión-del-gráfico-con-faceting"><span class="header-section-number">4.4</span> Subdivisión del gráfico con faceting</a>
  <ul class="collapse">
  <li><a href="#multifaceting" id="toc-multifaceting" class="nav-link" data-scroll-target="#multifaceting"><span class="header-section-number">4.4.1</span> Multifaceting</a></li>
  </ul></li>
  <li><a href="#definiendo-la-estética-de-nuestros-gráficos" id="toc-definiendo-la-estética-de-nuestros-gráficos" class="nav-link" data-scroll-target="#definiendo-la-estética-de-nuestros-gráficos"><span class="header-section-number">4.5</span> Definiendo la estética de nuestros gráficos</a>
  <ul class="collapse">
  <li><a href="#exportación-y-edición-posterior-un-arma-de-doble-filo" id="toc-exportación-y-edición-posterior-un-arma-de-doble-filo" class="nav-link" data-scroll-target="#exportación-y-edición-posterior-un-arma-de-doble-filo"><span class="header-section-number">4.5.1</span> Exportación y edición posterior: un arma de doble filo</a></li>
  <li><a href="#definiendo-el-theme-en-ggplot2" id="toc-definiendo-el-theme-en-ggplot2" class="nav-link" data-scroll-target="#definiendo-el-theme-en-ggplot2"><span class="header-section-number">4.5.2</span> Definiendo el <code>theme</code> en ggplot2</a></li>
  <li><a href="#fuentes" id="toc-fuentes" class="nav-link" data-scroll-target="#fuentes"><span class="header-section-number">4.5.3</span> Fuentes</a></li>
  </ul></li>
  <li><a href="#división-de-la-ventana-gráfica" id="toc-división-de-la-ventana-gráfica" class="nav-link" data-scroll-target="#división-de-la-ventana-gráfica"><span class="header-section-number">4.6</span> División de la ventana gráfica</a>
  <ul class="collapse">
  <li><a href="#layout" id="toc-layout" class="nav-link" data-scroll-target="#layout"><span class="header-section-number">4.6.1</span> layout</a></li>
  <li><a href="#par" id="toc-par" class="nav-link" data-scroll-target="#par"><span class="header-section-number">4.6.2</span> par</a></li>
  <li><a href="#grid.arrange" id="toc-grid.arrange" class="nav-link" data-scroll-target="#grid.arrange"><span class="header-section-number">4.6.3</span> grid.arrange</a></li>
  <li><a href="#patchwork" id="toc-patchwork" class="nav-link" data-scroll-target="#patchwork"><span class="header-section-number">4.6.4</span> patchwork</a></li>
  </ul></li>
  <li><a href="#actividad-6" id="toc-actividad-6" class="nav-link" data-scroll-target="#actividad-6"><span class="header-section-number">4.7</span> Actividad 6</a></li>
  </ul></li>
  <li><a href="#unidad-5.-otros-tipos-y-parámetros-gráficos" id="toc-unidad-5.-otros-tipos-y-parámetros-gráficos" class="nav-link" data-scroll-target="#unidad-5.-otros-tipos-y-parámetros-gráficos"><span class="header-section-number">5</span> Unidad 5. Otros tipos y parámetros gráficos</a>
  <ul class="collapse">
  <li><a href="#gráficos-de-área" id="toc-gráficos-de-área" class="nav-link" data-scroll-target="#gráficos-de-área"><span class="header-section-number">5.1</span> Gráficos de área</a></li>
  <li><a href="#combinando-gráficos-de-distinto-tipo" id="toc-combinando-gráficos-de-distinto-tipo" class="nav-link" data-scroll-target="#combinando-gráficos-de-distinto-tipo"><span class="header-section-number">5.2</span> Combinando gráficos de distinto tipo</a></li>
  <li><a href="#pivoteando-pivoting" id="toc-pivoteando-pivoting" class="nav-link" data-scroll-target="#pivoteando-pivoting"><span class="header-section-number">5.3</span> Pivoteando (pivoting)</a>
  <ul class="collapse">
  <li><a href="#pivot_longer" id="toc-pivot_longer" class="nav-link" data-scroll-target="#pivot_longer"><span class="header-section-number">5.3.1</span> pivot_longer</a></li>
  <li><a href="#pivot_wider" id="toc-pivot_wider" class="nav-link" data-scroll-target="#pivot_wider"><span class="header-section-number">5.3.2</span> pivot_wider</a></li>
  </ul></li>
  <li><a href="#gráficos-de-biplot-para-análisis-multivariado" id="toc-gráficos-de-biplot-para-análisis-multivariado" class="nav-link" data-scroll-target="#gráficos-de-biplot-para-análisis-multivariado"><span class="header-section-number">5.4</span> Gráficos de biplot para análisis multivariado</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gráficos para publicaciones en R con énfasis en ggplot2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés Blanco </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 31, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
<section id="objetivos" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="objetivos">Objetivos</h2>
<p>El objetivo principal del curso es que los asistentes obtengan herramientas para la generación y manejo de gráficos utilizando lenguaje R y el software RStudio, con especial énfasis en la escritura que requiere el paquete ggplot2.</p>
</section>
<section id="contenidos" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="contenidos">Contenidos</h2>
<ol type="1">
<li>Unidad 1. Introducción a R y RStudio. Presentación de los programas. Estructura del script de trabajo. Carga de datos y librerías. Caracterización analítica y gráfica de las variables. Tipos de objetos. Paquete dplyr para manejo y conversión de las bases de datos.<br>
</li>
<li>Unidad 2. Análisis y representación de datos numéricos. Correlación lineal en R. Gráficos de correlaciones. Regresión lineal. Gráficos de supuestos. Gráficos de puntos: función plot y lineplot.CI. Manejo de parámetros gráficos. Ggplot2: introducción al paquete, gráficos de puntos y líneas. Gráfica del modelo lineal. Cálculos de media y desvío estándar para gráficos.</li>
<li>Unidad 3. Análisis y representación de datos categóricos. ANOVA a 1 factor y bifactorial. Pruebas de supuestos y test a posteriori. Gráficos de barras: función bargraph.CI y geom_col.&nbsp;Gráficos de cajas: función boxplot y geom_boxplot. Manejo de escalas e incorporación de resultados estadísticos.</li>
<li>Unidad 4. Estructura y estética de gráficos con ggplot2. Estructura por capas. Faceting y división por factores. Definición del theme. Manipulación de la base de datos a graficar. Escalas de colores, uso de paletas. Clasificación por color, tipo de línea y forma. Combinación de gráficos: funciones layout, grid.arrange y paquete patchwork.</li>
<li>Unidad 5. Otros tipos y parámetros gráficos. Gráficos de áreas. Combinación de distintos geoms. Eje secundario. Pivoteo de bases de datos. Gráficos de biplot para análisis de componentes principales. Exportación de gráficos: devices y ggsave. Manipulación externa de gráficos.</li>
</ol>
</section>
<section id="introducción-a-r-y-rstudio" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción a R y RStudio</h1>
<section id="el-lenguaje-r" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="el-lenguaje-r"><span class="header-section-number">1.1</span> El lenguaje R</h2>
<p>R es un lenguaje de escritura propio. Como todo lenguaje, tiene la gran virtud de que permite la comunicación a través de él, se puede intercambiar, podemos “hablarlo” en todas partes del mundo, compartir <em>scripts</em> con colegas y mostrarles cómo analizamos los datos. Sin embargo, su principal virtud es también su kryptonita ya que, como todo lenguaje, tiene muchos modismos. Cada persona desarrolla su propia forma de escritura, arma los <em>scripts</em> como le parece conveniente, entendible, práctico. Uno mismo a lo largo del tiempo va perfeccionando sus propios escritos, corrigiendo lo antes hecho, reescribiendo con un estilo más refinado o más avanzado.</p>
<p>Mi reflexión a este respecto es que la experiencia con el software es dinámica, aquí no se pretende mostrar una receta cerrada que no se puede modificar (ni mucho menos), sino simplemente acercar el programa a aquellos que aún no lo conocen y permitirles dar los primeros pasos para luego iniciar su propio camino.</p>
</section>
<section id="ventajas-y-desventajas-de-r" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="ventajas-y-desventajas-de-r"><span class="header-section-number">1.2</span> Ventajas y desventajas de R</h2>
<p>Por supuesto este apartado es totalmente subjetivo y (al igual que todo este escrito) está enteramente marcado por mi experiencia personal. La principal desventaja salta a la vista: hay que aprender un lenguaje nuevo de escritura. De esta desventaja se desprende su principal limitación: requiere tiempo aprenderlo. El uso de R requiere tener paciencia, leer, aprender a utilizarlo, frustrarse, reintentar, googlear buscando ayuda, etc. Por otra parte, la flexibilidad de escritura a veces dificulta el entendimiento. Finalmente algo que puede parecer una desventaja (que ya veremos que no lo es) es que en algunos casos puede llevarnos bastante tiempo llegar a un gráfico aceptable de acuerdo a nuestro requerimientos, gráfico que a simple vista pareciera haber sido mucho más rápido hacerlo en otro software ya conocido (como excel).</p>
<p>De ahí en más, presenta muchas virtudes:</p>
<ul>
<li>En primer lugar es software libre, al acceso de todos y multiplataforma.</li>
<li>Se usa en investigación en todas partes del mundo, lo que nos permite realizar intercambios con otros investigadores, mandar scripts a nuestros directores, colegas, consultar análisis de otros.</li>
<li>En lo personal, nos facilita seguir paso a paso cómo analizamos nuestros propios datos. Pongamos por caso que luego de 2 años queremos revisar unos datos que ya habíamos analizado y que nos quedaron colgados…acá podemos ver paso a paso todo lo que hicimos (también es cierto que si seguimos avanzando en el programa, nuestra forma de escritura habrá mutado, pero eso no lo hará menos entendible).</li>
<li>Otra ventaja, relacionada a la anterior, es la posibilidad de introducir comentarios en nuestros scripts. Todo lo que aparezca a la derecha del signo <code>#</code> en una línea no formará parte de la corrida. Esto nos permite agregar anotaciones, incluso resultados, hacernos recordatorios, silenciar partes del script que no queramos que se ejecuten, etc.</li>
<li>La esencia de R es la capacidad de repetición. Retomando lo que mencioné como una supuesta desventaja (pero que no lo era), una vez que logramos un gráfico (puede ser también un comando, pero vale el ejemplo) que estéticamente nos agrada, es muy sencillo extrapolar esa apariencia a otro gráfico, aún de diferente tipo. Por lo tanto, todo ese tiempo que nos llevó armarlo, es inversión y aprendizaje para que la siguiente vez todo sea más rápido.</li>
<li>El uso de funciones: relacionado al ítem anterior, y una vez que tengamos algo de manejo, podemos armar las funciones que nosotros queramos reuniendo los análisis que queramos ver y simplificar los comandos para que en una sola línea generemos mucha información.</li>
</ul>
</section>
<section id="instalación-de-r" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="instalación-de-r"><span class="header-section-number">1.3</span> Instalación de R</h2>
<p>En windows, se debe descargar la última versión de R desde su web (<a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a>), e instalarlo como cualquier otro programa.</p>
</section>
<section id="rstudio" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="rstudio"><span class="header-section-number">1.4</span> RStudio</h2>
<p>RStudio es un software que nos va a permitir trabajar de un modo más amigable con R (que de forma nativa se utiliza en un entorno tipo terminal de programación). El programa es de uso libre y se descarga desde la web oficial (<a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a>). Una vez que instalamos el programa y lo abrimos, nos ofrece muchísimas posibilidades. En este taller simplemente vamos a ver su uso básico.</p>
<p>Al abrir el programa lo primero que destaca es que se encuentra dividido en 4 ventanas:</p>
<p><img src="images/rstudio.png" class="img-fluid"></p>
<ol type="1">
<li><p>Ventana 1 - Script de trabajo: arriba a la izquierda. En ella abriremos y editaremos nuestros scripts de trabajo. A medida que se escriben las líneas para ejecutarlas debemos posicionarnos en ella (o seleccionarla) y correrlas (Run, arriba a la derecha, o más fácil <em>Ctrl + r</em>).</p></li>
<li><p>Ventana 2 - consola: se ubica abajo a la izquierda. En ella se nos muestra el R propiamente dicho. Todo lo que nosotros ejecutamos en la ventana 1 se corre en esta segunda ventana, donde se nos muestra el resultado de nuestra corrida. Si se quiere se puede escribir directamente en ella, pero lo que hagamos no quedará guardado en nuestro script de trabajo.</p></li>
<li><p>Ventana 3 - objetos e historial: arriba a la derecha. Aquí podemos visualizar (en la pestaña <em>Environment</em>) todos los objetos, bases de datos, funciones, etc. que hayamos importado o creado. Es muy importante ya que nos permite tener en vista nuestro entorno de trabajo (que es una funcionalidad con la que el R nativo no cuenta, uno debe memorizar los objetos creados). Si se tilda en alguno de los objetos, es equivalente a ejecutar el comando <code>View()</code>, y nos permite visualizar en forma de tabla nuestras bases de datos (se abren en la ventana 1). Contamos aquí con una opción gráfica para importar nuestras bases de datos, pero en este curso lo haremos directamente con código. También contamos con una escoba que nos permite borrar todos los objetos que tengamos. La segunda pestaña <em>History</em> nos permite precisamente ver el historial de corridas que hayamos hecho. Allí podemos revisar comandos que ya ejecutamos y queremos repetir.</p></li>
<li><p>Ventana 4 - gráficos, paquetes y ayuda: abajo a la derecha. Usaremos 3 de las pestañas:</p></li>
</ol>
<ul>
<li><em>Plots</em>: aquí visualizaremos todos los gráficos que vayamos generando. Nos permite mediante las flechas de arriba a la izquierda ir viendo también los gráficos anteriores. El icono Zoom nos facilita la visualización externa del gráfico que estemos viendo. Además presenta opciones de exportación.</li>
<li><em>Packages</em>: aquí podemos visualizar la lista completa de paquetes que tenemos instalados. Si tildamos uno lo activamos (equivalente al comando <code>library</code>, ver más adelante). Si tildamos en <em>Install</em> podemos agregar nuevos paquetes que estén en el CRAN (base de datos de librerías).</li>
<li><em>Help</em>: como bien dice el nombre es la ventana de ayuda. Súper útil y de consulta constante. Allí podemos ver las descripciones que escribieron los creadores de cada función y/o paquete que usemos.</li>
</ul>
<p>Como se ve RStudio nos permite realizar diversas acciones de forma gráfica, sin necesidad de utilizar código. Mi postura en general es dejar escrito en nuestro script la mayor cantidad de pasos posibles, ya que todo lo que hagamos de forma gráfica no nos queda disponible cuando volvamos a ver nuestro archivo. En este sentido, la instalación de paquetes o las búsquedas de ayuda no es algo que necesitemos en un futuro en nuestro script y podemos hacerlo de forma gráfica. Pero, contrariamente, la carga de la base de datos, paquetes, exportación de figuras, nos resultará de utilidad dejarlo plasmado en el escrito.</p>
<p>RStudio incluye un infinidad de opciones extra que no hacen al objetivo de este curso. Para usos más avanzados es recomendable revisar la página web de los creadores, que es muy completa e incluye muchas utilidades y tutoriales. También se encuentra mucha ayuda en la pestaña Help.</p>
</section>
<section id="script-de-trabajo" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="script-de-trabajo"><span class="header-section-number">1.5</span> Script de trabajo</h2>
<p>En este apartado comenzaremos propiamente a desarrollar un script de trabajo. Iremos viendo paso a paso como avanzar en su armado, desde la carga de las librerías, introducir la base de datos y el manejo de la misma, el análisis de los datos hasta la visualización gráfica de los mismos.</p>
<p>Lo primero que hay que hacer un vez ingresados en RStudio es crear un nuevo script (File -&gt; New File -&gt; R Script). Allí nosotros podremos ir desarrollando los comandos correspondientes.</p>
<p>Todo script de trabajo tiene una estructura similar, la que yo utilizo es:</p>
<ul>
<li>Carga de las librerías.</li>
<li>Carga de la base de datos.</li>
<li>Creación de las databases necesarias.</li>
<li>Armado de las funciones necesarias (si es que las tuviéramos).</li>
<li>Análisis de los datos separados por títulos.</li>
</ul>
<p>Los títulos son marcas que hacemos para volver sencillamente a otras partes de nuestro script (tengamos en cuenta que fácilmente se superan las 1000 líneas). Para introducir un título (o marcador) colocamos la palabra clave como un comentario y agregamos una serie de signos - a la derecha. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías ------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir de este momento podemos ver nuestros títulos en 2 lugares: en la parte inferior izquierda de la ventana 1 o en la parte superior derecha de la misma ventana en el icono con la leyenda <em>Outline</em>. Esta estructuración, insisto, es muy útil para movernos dentro del documento sin perder mucho tiempo buscando algún comando. A su vez, si introducimos más # al comienzo, se generan títulos de un nivel inferior.</p>
</section>
<section id="instalación-y-carga-de-las-librerías" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="instalación-y-carga-de-las-librerías"><span class="header-section-number">1.6</span> Instalación y carga de las librerías</h2>
<p>R se maneja en base a paquetes (o librerías) que contienen las funciones que queramos utilizar. Como base R trae pre-instalados una serie de paquetes que nos sirven para realizar gran cantidad de aplicaciones. Sin embargo, es muy usual que prefiramos usar otras funciones no disponibles en la base.</p>
<p>Para instalar una librería debemos ejecutar el código</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nombre del paquete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La instalación de paquetes debemos realizarla una única vez. Como se mencionó al describir la Ventana 4, también podemos instalar los paquetes de un modo gráfico en la pestaña Packages de RStudio.</p>
<p>Cada vez que ingresamos a RStudio debemos cargar nuestras librerías a utilizar. Para cargar una librería utilizamos el código</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nombre del paquete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos cargar varios paquetes, podemos ejecutar varios comandos library en una misma línea separándolos con “;”, y así cargar todos en una única línea de corrida (Ctrl + r). Por otro lado, si bien uno puede tener un conjunto de paquetes que utiliza habitualmente, no es recomendable cargar de más ya que muchas veces se solapan funciones y podemos tener alguna complicación.</p>
<p>Para el uso de este taller, instalaremos los paquetes <strong>agricolae</strong>, <strong>car</strong>, <strong>sciplot</strong>, <strong>patchwork</strong>, <strong>gridExtra</strong> , <strong>viridis</strong> y <strong>tidyverse</strong>. Este último incluye una serie de paquetes en su interior, que abarcan desde funcionalidades gráficas hasta opciones del manejo de datos.</p>
<p>Así podemos cargarlos todos de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae);<span class="fu">library</span>(tidyverse);<span class="fu">library</span>(car)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sciplot);<span class="fu">library</span>(patchwork); <span class="fu">library</span>(gridExtra)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="carga-de-nuestros-datos" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="carga-de-nuestros-datos"><span class="header-section-number">1.7</span> Carga de nuestros datos</h2>
<p>Como para casi cualquier acción que queramos ejecutar en R, la carga de la base de datos puede hacerse de muchas maneras. En la ventana 3 se nos ofrece una opción gráfica (a través de “Import Dataset”).</p>
<p>De todas maneras, es recomendable hacerlo mediante código, para que cada vez que ingresemos podamos incorporar la base de datos de manera muy sencilla.</p>
<section id="establecer-el-directorio-de-trabajo" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="establecer-el-directorio-de-trabajo"><span class="header-section-number">1.7.1</span> Establecer el directorio de trabajo</h3>
<p>Lo primero que debemos hacer es establecer el directorio de trabajo. Para ello corremos el comando (con un directorio ejemplo):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"D:/DATOS/R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos revisar en qué directorio nos encontramos, ejecutamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "D:/OneDrive/R/Taller R 2025 Doctorado/curso_graficos_ggplot/curso_completo"</code></pre>
</div>
</div>
<p>Ahora antes de ver cómo cargar la base de datos, haremos una breve explicación de como crear la base de datos.</p>
</section>
<section id="armado-de-la-base-de-datos" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="armado-de-la-base-de-datos"><span class="header-section-number">1.7.2</span> Armado de la base de datos</h3>
<p>Una vez más, aquí mostraré mi forma de armar las bases de datos, hay muchas..</p>
<p>La forma de la base de datos es la misma que se utiliza en otros software como Infostat. Debemos crear una columna por cada factor o variable que tengamos, y repetir el nivel del factor para cada unidad experimental (cada fila).</p>
<p>El formato en el que yo creo mis bases de datos es csv (archivo separado por comas). Para ello se exporta desde excel o calc el archivo en ese formato. El documento debe tener una única hoja con las base de datos limpia, es decir sin columnas o filas extras con comentarios, datos extra, etc. Por otro lado, es recomendable que los nombres de las columnas sean lo más cortos posibles, y que no tengan espacios. Otra recomendación es omitir el uso de tildes u otros caracteres especiales en cualquier parte del documento puede llegar a tener problemas según la codificación que usemos en RStudio. La más compatible es la UTF-8, que no suele generar problemas.</p>
<p>Resumiendo, la recomendación es que una vez que tenemos nuestra tabla (en excel por ejemplo) con los datos listos, copiarla y pegarla en un documento nuevo. Allí ver de simplificar los nombres de las columnas, también de los niveles de factores a utilizar. Guardar este nuevo documento como csv, si estamos en idioma español establecer para la separación de columnas “;”. Por supuesto, guardamos el archivo en el directorio de trabajo.</p>
<p>Para este curso utilizaremos inicialmente la base de datos “metals.csv”.</p>
</section>
<section id="cargando-la-base-de-datos" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="cargando-la-base-de-datos"><span class="header-section-number">1.7.3</span> Cargando la base de datos</h3>
<p>En este aparto, cabe destacar que R es un lenguaje orientado a objetos. Cargaremos nuestra base de datos como un “objeto” de R, al cual debemos asignarle un nombre. De ahí en más, cualquier acción que modifique nuestro “objeto” quedará guardada en el objeto mismo, pero no modificará nuestro archivo original (el csv en este caso). Para crear un objeto lo asignamos con “&lt;-” (de forma rápida se escribe con Alt + -) o con el signo “=”.</p>
<p>Una primera forma de cargarla es mediante la función read.csv, por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"metales.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como la base está en español, no se carga correctamente. Debemos corregir un par de parámetros:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"metales.csv"</span>, <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(metales, class) <span class="co"># vemos que crea factores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pote
[1] "integer"

$GT
[1] "character"

$CO2
[1] "integer"

$ET
[1] "character"

$Organo
[1] "character"

$PS
[1] "numeric"

$Mn
[1] "numeric"

$Cu
[1] "numeric"

$Zn
[1] "numeric"

$Cd
[1] "numeric"

$Pb
[1] "numeric"

$SPAD
[1] "numeric"</code></pre>
</div>
</div>
<p>La función que yo más utilizo es la que viene con el paquete tidyverse, llamada <code>read_csv</code>. Si usamos <code>read_csv2</code>, toma la coma como separador decimal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"metales.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 142 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (3): GT, ET, Organo
dbl (9): Pote, CO2, PS, Mn, Cu, Zn, Cd, Pb, SPAD

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Vemos que en este caso nos mostró directamente la clase de cada columna, y que crea objetos tipo character en vez de factor.</p>
<p>En la ventana 3, nos aparecerán los objetos que incorporemos.</p>
</section>
</section>
<section id="caracterización-de-la-base-de-datos" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="caracterización-de-la-base-de-datos"><span class="header-section-number">1.8</span> Caracterización de la base de datos</h2>
<p>Para ver primeros datos y los nombres de las columnas ejecutamos los comandos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
   Pote GT          CO2 ET    Organo    PS    Mn    Cu    Zn    Cd    Pb  SPAD
  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1 ES Mentor   400 No    Hoja    4.58  53.9 10.3  103.  1.30   7.22  29.5
2     2 ES Mentor   400 No    Hoja    3.61  51.1  7.36 149.  1.09   2.75  21.5
3     3 ES Mentor   400 No    Hoja    4.27  41.7  6.90  96.9 0.956  2.53  24.7
4     4 ES Mentor   400 Si    Hoja    4.62  54.0  8.77 119.  0.901  3.05  22.6
5     5 ES Mentor   400 Si    Hoja    4.68  51.2  6.64 108.  1.16   3.21  25.6
6     6 ES Mentor   400 Si    Hoja    4.38  50.3  8.16 111.  0.682  3.69  22.8</code></pre>
</div>
</div>
<p>Para ver la tabla completa, se debe tildar en el nombre del objeto en la ventana 3. Aprovechando que tenemos la tabla a nuestra vista, daré aquí una breve descripción de los datos. La tabla cargada cuenta con datos de plantas de soja de 3 cultivares (o genotipos) diferentes: Alim 3,14, ES Mentor y Sigalia (todos en la columna GT). Estas plantas crecieron en cámaras climáticas con condiciones controladas de luz, temperatura, humedad y concentración de CO<sub>2</sub>. Las siguientes columnas de la base de datos son las siguientes:</p>
<ul>
<li><p>CO<sub>2</sub>: es la concentración en la cual crecieron las plantas. Tiene dos niveles: 400 ppm y 550 ppm.</p></li>
<li><p>ET: estrés térmico. Algunas de las plantas fueron sometidas a estrés térmico en el periodo crítico de llenado de grano. Tiene dos niveles: Sí o No.</p></li>
<li><p>Órgano: refiere a si se trata de raíces, tallos, hojas, vainas o semillas.</p></li>
<li><p>PS: peso seco del órgano correspondiente.</p></li>
<li><p>Mn, Cu, Zn, Pb, Cd: concentración del metal en el órgano correspondiente en ppm.</p></li>
<li><p>SPAD: medición promedio de SPAD (verdor) en hojas a lo largo del desarrollo. Valor sólo válido para las hojas.</p></li>
</ul>
<p>Además podemos ver un resumen de nuestra base o hacerle “preguntas” a R sobre la base de datos. Al escribir “$” a continuación de un objeto podemos ver las columnas individuales. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(metales) <span class="co"># resumen de la base</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Pote            GT                 CO2           ET           
 Min.   : 1.00   Length:142         Min.   :400   Length:142        
 1st Qu.:10.00   Class :character   1st Qu.:400   Class :character  
 Median :18.50   Mode  :character   Median :475   Mode  :character  
 Mean   :18.46                      Mean   :475                     
 3rd Qu.:27.00                      3rd Qu.:550                     
 Max.   :36.00                      Max.   :550                     
    Organo                PS               Mn               Cu        
 Length:142         Min.   : 1.030   Min.   : 2.122   Min.   : 2.568  
 Class :character   1st Qu.: 1.875   1st Qu.: 7.952   1st Qu.: 5.899  
 Mode  :character   Median : 2.720   Median :20.450   Median : 7.272  
                    Mean   : 3.561   Mean   :24.086   Mean   :10.582  
                    3rd Qu.: 4.215   3rd Qu.:34.296   3rd Qu.:12.472  
                    Max.   :12.330   Max.   :83.826   Max.   :38.300  
       Zn               Cd              Pb               SPAD      
 Min.   : 13.41   Min.   :0.623   Min.   : 0.0340   Min.   :20.27  
 1st Qu.: 43.06   1st Qu.:0.961   1st Qu.: 0.1308   1st Qu.:23.09  
 Median : 80.55   Median :1.207   Median : 2.1740   Median :25.84  
 Mean   : 91.42   Mean   :1.336   Mean   : 2.7108   Mean   :25.76  
 3rd Qu.:103.41   3rd Qu.:1.667   3rd Qu.: 4.4465   3rd Qu.:27.69  
 Max.   :345.52   Max.   :2.849   Max.   :11.6470   Max.   :32.24  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.double</span>(metales<span class="sc">$</span>PS) <span class="co"># double indica numérico continuo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(metales<span class="sc">$</span>GT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(metales<span class="sc">$</span>GT)) <span class="co"># para ver los niveles de un factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alim 3,14" "ES Mentor" "Sigalia"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(metales<span class="sc">$</span>Organo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hoja"    "Semilla" "Tallo"   "Vaina"  </code></pre>
</div>
</div>
<section id="caracterización-gráfica" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="caracterización-gráfica"><span class="header-section-number">1.8.1</span> Caracterización gráfica</h3>
<p>En este caso haremos algunos gráficos sencillos para observar la distribución de nuestra base de datos. La función <code>plot</code> (y sus derivados, como en este caso <code>boxplot</code>) viene con R base y es la forma más rápida y sencilla de graficar.</p>
<div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(metales<span class="sc">$</span>PS<span class="sc">~</span>metales<span class="sc">$</span>Organo)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(metales<span class="sc">$</span>Pb<span class="sc">~</span>metales<span class="sc">$</span>GT)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(metales<span class="sc">$</span>Cd)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(metales<span class="sc">$</span>Pb<span class="sc">~</span>metales<span class="sc">$</span>Cd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manejo-de-la-base-de-datos" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="manejo-de-la-base-de-datos"><span class="header-section-number">1.9</span> Manejo de la base de datos</h2>
<section id="subdividir-la-base-de-datos" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="subdividir-la-base-de-datos"><span class="header-section-number">1.9.1</span> Subdividir la base de datos</h3>
<p>Algo muy común en el trabajo en R, es la necesidad de subdividir la base de datos para utilizar únicamente una parte de ella. Veremos un par de formas de hacerlo.</p>
<p>Con las funciones que incluye R base, utilizaremos <code>subset</code>. Por ejemplo para elegir solo las muestras del genotipo <em>Alim 3,14</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="ot">&lt;-</span> <span class="fu">subset</span>(metales, metales<span class="sc">$</span>GT<span class="sc">==</span><span class="st">"Alim 3,14"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y creamos un objeto que se llama <em>ALIM</em>, nuevamente mediante <em>&lt;-</em>.</p>
<p>Otra forma de hacerlo es mediante el uso de pipes (%&gt;%). Las pipes sirven para concatenar una serie de acciones para modificar una base de datos. En primer lugar se ubica la base a modificar y entre cada linea de comando %&gt;% (<em>Ctrl + Shift + m</em>). Así, podemos crear la misma base de antes con <code>filter</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GT <span class="sc">==</span> <span class="st">"Alim 3,14"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos filtrar por más de un parámetro:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en dos pasos</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ALIM_VyS <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(GT <span class="sc">==</span> <span class="st">"Alim 3,14"</span>) <span class="sc">%&gt;%</span> <span class="co"># se agrega a lo anterior</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Organo <span class="sc">==</span><span class="st">"Vaina"</span><span class="sc">|</span> Organo <span class="sc">==</span><span class="st">"Semilla"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="seleccionar-filas-o-columnas" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="seleccionar-filas-o-columnas"><span class="header-section-number">1.9.2</span> Seleccionar filas o columnas</h3>
<p>En R base, el uso de [ ] sirve para seleccionar filas o columnas de una database, tal que <code>data[filas,columnas]</code>. En el entorno de <em>dplyr</em> utilizaremos la función <code>select</code> para columnas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar filas 1 a 3</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>metales[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 12
   Pote GT          CO2 ET    Organo    PS    Mn    Cu    Zn    Cd    Pb  SPAD
  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1 ES Mentor   400 No    Hoja    4.58  53.9 10.3  103.  1.30   7.22  29.5
2     2 ES Mentor   400 No    Hoja    3.61  51.1  7.36 149.  1.09   2.75  21.5
3     3 ES Mentor   400 No    Hoja    4.27  41.7  6.90  96.9 0.956  2.53  24.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar columnas 1 a 3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>metales[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
    Pote GT          CO2
   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1     1 ES Mentor   400
 2     2 ES Mentor   400
 3     3 ES Mentor   400
 4     4 ES Mentor   400
 5     5 ES Mentor   400
 6     6 ES Mentor   400
 7     7 Sigalia     400
 8     8 Sigalia     400
 9     9 Sigalia     400
10    10 Sigalia     400
# ℹ 132 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>metales <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
    Pote GT          CO2
   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1     1 ES Mentor   400
 2     2 ES Mentor   400
 3     3 ES Mentor   400
 4     4 ES Mentor   400
 5     5 ES Mentor   400
 6     6 ES Mentor   400
 7     7 Sigalia     400
 8     8 Sigalia     400
 9     9 Sigalia     400
10    10 Sigalia     400
# ℹ 132 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar por nombre de la columna</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>metales <span class="sc">%&gt;%</span> <span class="fu">select</span>(GT,CO2,Pb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
   GT          CO2    Pb
   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 ES Mentor   400  7.22
 2 ES Mentor   400  2.75
 3 ES Mentor   400  2.53
 4 ES Mentor   400  3.05
 5 ES Mentor   400  3.21
 6 ES Mentor   400  3.69
 7 Sigalia     400  4.93
 8 Sigalia     400  6.89
 9 Sigalia     400  6.45
10 Sigalia     400  4.06
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section id="creación-de-nuevas-variables" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="creación-de-nuevas-variables"><span class="header-section-number">1.9.3</span> Creación de nuevas variables</h3>
<p>Una opción muy útil ligada al paquete <strong>dplyr</strong> es la de transformar nuestras bases de datos para algún gráfico en particular, sin necesidad de cambiar la tabla original. Para ello utilizaremos la función <code>mutate</code>, que permite generar muchos cambios en la base de datos. Por ejemplo, en la base ALIM, si queremos agregar la cantidad absoluta de Pb extraída:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>metales <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Pb_total"</span> <span class="ot">=</span> Pb<span class="sc">*</span>PS) <span class="co"># se crea una nueva columna</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># para ver la columna nueva</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>metales<span class="sc">$</span>Pb_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  33.06302   9.91306  10.79029  14.08638  15.00876  16.17096  20.29512
  [8]  27.08556  26.89233  16.41048  21.13308  13.07837  90.21291  47.62605
 [15]  34.42750  32.72702 104.37124  60.83160  11.97888  18.05868  11.41854
 [22]   9.45945  26.60670  14.74590  15.39456  10.70520  26.29791  21.00659
 [29]  29.45446  26.90309  56.83056  71.08245  28.40670  20.39830  22.12022
 [36]  15.66058   0.53040   0.21148   0.35308   0.12864   0.18957   0.15876
 [43]   0.34568   0.16218   0.26832   0.16653   0.13771   0.20181   1.30689
 [50]   0.26668   0.24779   0.06052   0.11200   0.13858   0.17000   0.09720
 [57]   0.11232   0.15456   0.21060   0.17806   0.13260   0.18768   0.31376
 [64]   0.43420   0.10500   0.19250   1.15430   1.39783   0.68175   0.09020
 [71]   0.12669   0.09306  19.56636  12.97743  15.53136   8.62628  22.82812
 [78]   6.70020  11.51128   8.49915  10.31240  12.42600   6.58415   3.86750
 [85]  40.15790  17.30625   7.66112  11.69561  13.83342  14.11765   3.68520
 [92]   3.53430   3.21594   5.76495   5.95000   3.79984   8.42044   9.41645
 [99]  11.57807  12.14784   6.73466   7.59570  48.02186  35.38976  33.43392
[106]  22.93984  10.68801   1.87756   0.12788   0.41223   3.65980   1.99801
[113]   0.22490   1.61504   2.01480   4.27158   1.36136   0.36025   8.40807
[120]   1.19240   0.75150   1.33900   1.48086   1.53242   0.71118   0.96642
[127]   0.95130   1.18125   2.77965   2.02789   2.81808   2.32225   0.66102
[134]   1.00975   1.17260   0.57710  12.66513  25.29600  14.93736   7.39102
[141]   0.57288   1.09347</code></pre>
</div>
</div>
</section>
<section id="cambio-en-los-niveles-de-un-factor" class="level3" data-number="1.9.4">
<h3 data-number="1.9.4" class="anchored" data-anchor-id="cambio-en-los-niveles-de-un-factor"><span class="header-section-number">1.9.4</span> Cambio en los niveles de un factor</h3>
<p>También podemos cambiar los niveles de una factor <code>mutate</code>, mediante la siguiente estructura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>... <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nombre_factor =</span> <span class="fu">fct_recode</span>(nombre_factor,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nombre nuevo"</span> <span class="ot">=</span> <span class="st">"nombre viejo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y podemos incluir una línea para cada nivel que queramos modificar. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ALIM <span class="sc">%&gt;%</span> <span class="fu">select</span>(CO2, ET, PS) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ET =</span> <span class="fu">fct_recode</span>(ET,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Control"</span>  <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Estrés térmico"</span> <span class="ot">=</span> <span class="st">"Si"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 47 × 3
     CO2 ET                PS
   &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;
 1   400 Control        10.7 
 2   400 Control         8.29
 3   400 Control         5.86
 4   400 Estrés térmico  7.46
 5   400 Estrés térmico  9.43
 6   400 Estrés térmico  8.15
 7   550 Control        11.8 
 8   550 Control        12.3 
 9   550 Control         9.45
10   550 Estrés térmico  8.45
# ℹ 37 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="actividad-1" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="actividad-1"><span class="header-section-number">1.10</span> Actividad 1</h2>
<ol type="1">
<li>Cree a partir de la base de datos original, una que contenga únicamente los tallos y hojas del cultivar ES Mentor, y las columnas de CO<sub>2</sub>, ET, Organo, PS, Zn y Pb.</li>
<li>Filtre la base creada para obtener otra que solo tenga aquellos datos con más de 3 ppm de Pb.</li>
</ol>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>
<section id="unidad-2.-análisis-y-representación-de-datos-numéricos" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Unidad 2. Análisis y representación de datos numéricos</h1>
<p>Veremos los análisis a realizar para procesar variables continuas (correlación y regresión) y como representarlas gráficamente de una forma más detallada que como lo vimos hasta ahora.</p>
<section id="correlación" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="correlación"><span class="header-section-number">2.1</span> Correlación</h2>
<p>Cuando queremos evaluar la relación entre 2 variables continuas, sin establecer relaciones de dependencia, el análisis que debemos hacer es un análisis de correlación lineal. El test de correlación lineal más utilizado es el de correlación de Pearson, que nos arroja el coeficiente de Pearson, que toma valores entre -1 y 1, según la relación sea inversa o directa. Valores cercanos a cero indican falta de relación entre las variables. La correlación de Pearson tiene como supuestos la distribución normal de las variables (entre otros). Debemos poner a prueba esos supuestos para poder realizar este tipo de análisis.</p>
<p>Comenzaremos creando una base de datos de las semillas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SEM <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organo <span class="sc">==</span> <span class="st">"Semilla"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veremos primero como analizar de a pares de variables. Lo recomendable es iniciar con una exploración gráfica de los datos, en este caso vamos a relacionar la acumulación de Cu y Zn en semillas.</p>
<div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploración gráfica</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SEM<span class="sc">$</span>Cu, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SEM<span class="sc">$</span>Zn, <span class="at">pch =</span> <span class="dv">17</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SEM<span class="sc">$</span>Cu, SEM<span class="sc">$</span>Zn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<p>Vemos que hay un valor extremo en el gráfico de Cu, para identificarlo podemos correr <em>identify</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SEM<span class="sc">$</span>Cu)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identify</span>(SEM<span class="sc">$</span>Cu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora veremos cómo hacer la correlación de pearson, de momento ignorando los supuestos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SEM<span class="sc">$</span>Cu, SEM<span class="sc">$</span>Zn, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SEM$Cu and SEM$Zn
t = 5.4405, df = 34, p-value = 4.599e-06
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4558295 0.8256796
sample estimates:
      cor 
0.6822013 </code></pre>
</div>
</div>
<p>Vemos que nos arroja los resultados del valor del coeficiente lineal de pearson y su valor p asociado.</p>
<section id="análisis-de-normalidad" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="análisis-de-normalidad"><span class="header-section-number">2.1.1</span> Análisis de normalidad</h3>
<p>En esta sección veremos cómo poner a prueba la normalidad de nuestros datos con el test de Shapiro Wilk y como visualizarlo gráficamente en un qqplot. Recordemos que la hipótesis nula del test es que los datos son normales, por lo que si rechazamos la hipótesis (p&lt;0,05) no hay normalidad:</p>
<div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma analítica</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(SEM<span class="sc">$</span>Cu)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(SEM<span class="sc">$</span>Zn)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma gráfica</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SEM<span class="sc">$</span>Cu)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(SEM<span class="sc">$</span>Cu, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SEM<span class="sc">$</span>Zn)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(SEM<span class="sc">$</span>Zn, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
    Shapiro-Wilk normality test

data:  SEM$Cu
W = 0.87266, p-value = 0.0006623</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
    Shapiro-Wilk normality test

data:  SEM$Zn
W = 0.97345, p-value = 0.527</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<p>Vemos que para el caso del Cu no son normales los datos de acuerdo con el test analítico, aunque el gráfico muestra un valor extremo. En una primera instancia podemos transformar las variables, que en R lo podemos hacer directamente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log</span>(SEM<span class="sc">$</span>Cu)) <span class="co"># convertimos al logaritmo en base 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log(SEM$Cu)
W = 0.86508, p-value = 0.0004317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(SEM<span class="sc">$</span>Cu))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">log</span>(SEM<span class="sc">$</span>Cu), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Sigue sin mostrar normalidad. Como vimos antes, el primer valor es mucho más alto que sus réplicas, si tomáramos la decisión de extraerlo hacemos el test sin él:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(SEM[<span class="sc">-</span><span class="dv">1</span>,]<span class="sc">$</span>Cu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  SEM[-1, ]$Cu
W = 0.87851, p-value = 0.001098</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SEM[<span class="sc">-</span><span class="dv">1</span>,]<span class="sc">$</span>Cu)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(SEM[<span class="sc">-</span><span class="dv">1</span>,]<span class="sc">$</span>Cu, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos conformarnos con la eliminación, y correr el test así (no olvidar eliminar el valor en ambas bases de datos):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SEM[<span class="sc">-</span><span class="dv">1</span>,]<span class="sc">$</span>Cu, SEM[<span class="sc">-</span><span class="dv">1</span>,]<span class="sc">$</span>Zn, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SEM[-1, ]$Cu and SEM[-1, ]$Zn
t = 7.5311, df = 33, p-value = 1.161e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6283377 0.8919974
sample estimates:
      cor 
0.7950977 </code></pre>
</div>
</div>
<p>Si no logramos de ninguna manera corregir la normalidad, podemos también correr el test no paramétrico de Spearman que no tiene supuestos asociados, aunque también presenta menor potencia. En este caso el coeficiente es el coeficiente de Spearman (<em>rho</em>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SEM<span class="sc">$</span>Cu, SEM<span class="sc">$</span>Zn,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">exact =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  SEM$Cu and SEM$Zn
S = 2004.8, p-value = 2.233e-07
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.7419853 </code></pre>
</div>
</div>
</section>
<section id="muchas-columnas-a-la-vez" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="muchas-columnas-a-la-vez"><span class="header-section-number">2.1.2</span> Muchas columnas a la vez</h3>
<p>Existen otros test que permiten correlacionar pares de variables pero correrlas todas a la vez. A diferencia de la función <code>cor.test</code> que solo admite 2 variables, la función <code>cor</code> permite cargar una serie de columnas y luego podemos ver los coeficientes en forma matricial:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>CORR <span class="ot">&lt;-</span> <span class="fu">cor</span>(SEM[, <span class="fu">c</span>(<span class="st">"Pb"</span>, <span class="st">"Cd"</span>, <span class="st">"Mn"</span>, <span class="st">"Cu"</span>, <span class="st">"Zn"</span>)],</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>CORR <span class="co"># obtenemos los coeficientes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Pb         Cd         Mn         Cu            Zn
Pb 1.0000000000  0.1480843  0.3825917  0.1104054  0.0009652035
Cd 0.1480843231  1.0000000 -0.3435795  0.2023747  0.6365851679
Mn 0.3825916853 -0.3435795  1.0000000 -0.3945261 -0.3955337272
Cu 0.1104053538  0.2023747 -0.3945261  1.0000000  0.6822013201
Zn 0.0009652035  0.6365852 -0.3955337  0.6822013  1.0000000000</code></pre>
</div>
</div>
<p>Otra función de utilidad que nos permite ver los coeficientes y los valores p al mismo tiempo es la función <code>rcorr</code> del paquete <strong>Hmisc</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Hmisc' was built under R version 4.4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>CORR.Sem <span class="ot">&lt;-</span> <span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(SEM[,<span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>])) <span class="co">#argumento matricial</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>CORR.Sem <span class="co"># aquí observamos primero los valores de coeficientes y luego el valor p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Mn    Cu    Zn    Cd   Pb
Mn  1.00 -0.39 -0.40 -0.34 0.38
Cu -0.39  1.00  0.68  0.20 0.11
Zn -0.40  0.68  1.00  0.64 0.00
Cd -0.34  0.20  0.64  1.00 0.15
Pb  0.38  0.11  0.00  0.15 1.00

n= 36 


P
   Mn     Cu     Zn     Cd     Pb    
Mn        0.0173 0.0170 0.0402 0.0213
Cu 0.0173        0.0000 0.2365 0.5215
Zn 0.0170 0.0000        0.0000 0.9955
Cd 0.0402 0.2365 0.0000        0.3887
Pb 0.0213 0.5215 0.9955 0.3887       </code></pre>
</div>
</div>
<p>Ahora veremos dos paquetes que nos permiten ver en forma gráfica el resultado de nuestra correlación. El primero es el paquete <strong>corrplot</strong> del cual usaremos las funciones <code>cor.mtest</code> y <code>corrplot</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>pValues <span class="ot">&lt;-</span> <span class="fu">cor.mtest</span>(SEM[,<span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>]) <span class="co"># generamos un objeto de los valores p</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(CORR.Sem<span class="sc">$</span>r,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">'grey20'</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.mat =</span> pValues<span class="sc">$</span>p, <span class="co"># para ver los valores p</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">insig =</span> <span class="st">'blank'</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finalmente, introduciré la función <code>chart.Correlation</code> del paquete <strong>PerformanceAnalytics</strong>, que permite visualizar interacciones, gráficos de dispersión, coeficientes de correlación y significancia todo al mismo tiempo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"PerformanceAnalytics"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(SEM[,<span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">histogram=</span><span class="cn">TRUE</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Los invito a profundizar más en el uso de los paquetes por su propia cuenta.</p>
</section>
</section>
<section id="regresión-lineal-simple" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="regresión-lineal-simple"><span class="header-section-number">2.2</span> Regresión lineal simple</h2>
<p>El análisis de regresión lineal tiene algunos parecidos con el de correlación, pero en este caso hay una de la variables que consideramos que influye en la otra. Es decir, que hay una variable <em>x</em> independiente (regresora) y una <em>y</em> dependiente. Ambas variables deben ser numéricas. El modelo plantea el ajuste lineal de los datos, por lo tanto hay pruebas de hipótesis para la ordenada al origen y la pendiente de la recta de ajuste. Los supuestos del modelo son la distribución normal de las variables y la homogeneidad de los errores. Un detalle importante, es que el modelo solo es válido en el rango de nuestra <em>x</em>.</p>
<p>Por otro lado, existe un parámetro llamado el coeficiente de determinación (R<sup>2</sup>) que nos da una idea de qué porcentaje de variabilidad de <em>y</em> está siendo explicado con <em>x</em>. Este coeficiente toma valores entre 0 y 1, cuanto mayor es mejor es el ajuste de nuestra nube de puntos a la recta.</p>
<p>En nuestro ejemplo para desarrollar una regresión lineal simple, relacionaremos el verdor de las hojas (a través de la medición SPAD) con el Pb acumulado en las mismas. Para ello generaremos una base de datos para las hojas, y haremos un gráfico rápido para ver esa relación:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>HOJA <span class="ot">&lt;-</span> metales <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organo <span class="sc">==</span> <span class="st">"Hoja"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HOJA<span class="sc">$</span>SPAD, HOJA<span class="sc">$</span>Pb, <span class="at">pch=</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para realizar una regresión lineal (y que en realidad será de la misma manera para un ANOVA), se debe plantear un modelo lineal mediante la función <code>lm</code> de la forma lm(y~x):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span><span class="fu">lm</span>(Pb <span class="sc">~</span> SPAD, <span class="at">data =</span> HOJA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez creado el objeto, vamos a poner a prueba los supuestos, tanto de forma gráfica como analítica. Al someter nuestro modelo a la función <code>plot</code>, se nos crean 4 gráficos para poner a prueba los supuestos. Para verlos todos juntos dividiremos la ventana gráfica con la función <code>layout</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de supuestos</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)); <span class="fu">plot</span>(fit1) ;<span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vemos en los dos gráficos superiores la dispersión de los datos, debemos fijarnos que sea homogénea sin patrones claros. Luego abajo a la derecha nos aparece en qqplot que ya viéramos anteriormente. Finalmente a la izquierda el gráfico de <em>residuos vs leverage</em> que nos permite visualizar la distancia de Cook’s. En forma resumida este parámetro nos permite detectar valores muy influyentes en nuestro resultado y que habría que revisarlos, especialmente si el valor de la distancia es mayor a 1. En nuestro ejemplo, el valor 17 presenta cierta influencia, pero no tanta como para concentrarnos en él. Además podemos poner a prueba de forma analítica la normalidad de los errores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(fit1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(fit1)
W = 0.98603, p-value = 0.9207</code></pre>
</div>
</div>
<p>Como no se rechaza la hipótesis nula (p&gt;0,05), no tenemos evidencia para decir que la distribución no sea normal.</p>
<p>Una vez puestos a prueba los supuestos, procedemos a ver la tabla de regresión:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pb ~ SPAD, data = HOJA)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.78646 -0.76173  0.08411  0.66012  3.08197 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -8.43169    1.62522  -5.188 9.79e-06 ***
SPAD         0.51098    0.06243   8.185 1.51e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.221 on 34 degrees of freedom
Multiple R-squared:  0.6634,    Adjusted R-squared:  0.6535 
F-statistic:    67 on 1 and 34 DF,  p-value: 1.507e-09</code></pre>
</div>
</div>
<p>Allí podemos ver los resultados de la prueba de hipótesis para la ordenada al origen, la pendiente, el valor de R<sup>2</sup> y el p del R<sup>2</sup>. En nuestro caso el modelo obtenido será <em>y= -8,43 + 0,51 x</em> y explica el 65% de la variabilidad.</p>
<p>El modelo de regresión también puede ser aplicado a una variable <em>x</em> discreta, donde para cada valor de <em>x</em> se encuentren varios valores de <em>y</em> . Para ejemplificar vamos a discretizar nuestra variable SPAD:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos una nueva columna</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>HOJA<span class="sc">$</span>SPAD_cat <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">round</span>(HOJA<span class="sc">$</span>SPAD, <span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HOJA<span class="sc">$</span>SPAD_cat, HOJA<span class="sc">$</span>Pb, <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Y corremos nuevamente el modelo, ahora sí podemos hacer un test para homogeneidad de varianzas y un boxplot de los residuos (errores):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span><span class="fu">lm</span>(Pb <span class="sc">~</span> SPAD_cat, <span class="at">data =</span> HOJA)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de supuestos</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)); <span class="fu">plot</span>(fit2) ;<span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(fit2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(fit2)
W = 0.98305, p-value = 0.8429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">resid</span>(fit2)<span class="sc">~</span>HOJA<span class="sc">$</span>SPAD_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  resid(fit2) by HOJA$SPAD_cat
Bartlett's K-squared = 13.039, df = 10, p-value = 0.2215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(fit2,<span class="at">type=</span><span class="st">"pearson"</span>)<span class="sc">~</span>HOJA<span class="sc">$</span>SPAD_cat,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Pearson standarized residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tablas</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pb ~ SPAD_cat, data = HOJA)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8450 -0.6495 -0.0374  0.6626  3.2119 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -8.17737    1.63362  -5.006 1.69e-05 ***
SPAD_cat     0.50105    0.06273   7.988 2.62e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.24 on 34 degrees of freedom
Multiple R-squared:  0.6524,    Adjusted R-squared:  0.6421 
F-statistic:  63.8 on 1 and 34 DF,  p-value: 2.623e-09</code></pre>
</div>
</div>
<p>Vemos que el resultado es muy similar al de antes, por supuesto.</p>
<p>El modelo de regresión lineal puede ser complejizado agregando más variables regresoras. El planteo del modelo es muy similar, agregando las nuevas variables y su interacción, por ejemplo para dos regresoras: lm(y~ x<sub>1</sub> + x<sub>2</sub> + x<sub>1</sub>*x<sub>2</sub>). Este tipo de modelos exceden los alcances de este taller.</p>
</section>
<section id="actividad-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="actividad-2"><span class="header-section-number">2.3</span> Actividad 2</h2>
<ol type="1">
<li>A partir de la base de datos creada en el punto 1 de la actividad 1, realice un modelo de regresión que relaciones el PS con la acumulación de Zn en tallos.</li>
<li>Ponga a prueba los supuestos y concluya.</li>
</ol>
<hr>
</section>
<section id="gráficos-de-puntos" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="gráficos-de-puntos"><span class="header-section-number">2.4</span> Gráficos de puntos</h2>
<p>En este apartado veremos cómo una vez que tengamos una correlación o regresión lineal hecha visualizarla gráficamente de un modo agradable.</p>
<section id="función-plot" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="función-plot"><span class="header-section-number">2.4.1</span> Función plot</h3>
<p>La forma más rápida es mediante la función <code>plot</code> de Rbase</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pb<span class="sc">~</span>SPAD, <span class="at">data =</span> HOJA, <span class="at">pch=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="función-lineplot.ci-paquete-sciplot" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="función-lineplot.ci-paquete-sciplot"><span class="header-section-number">2.4.2</span> Función lineplot.CI (paquete sciplot)</h3>
<p>Con el paquete <strong>sciplot</strong>, podemos crear gráficos de manera rápida y estéticamente más trabajada con la función <code>lineplot.CI</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> Pb,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> HOJA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si queremos ver qué otras opciones ofrece la función, podemos ir a buscar la ayuda de la misma. Para ver la ayuda de la función ejecutamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>?lineplot.CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y se nos abrirá la ayuda en la ventana 4 de RStudio. Allí vemos una serie de parámetros que podemos modificar. A su vez podemos subdividir en grupos, veamos un ejemplo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> Pb,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> HOJA, <span class="co"># dataset</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">group =</span> ET, <span class="co"># criterio de agrupamiento</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"seagreen"</span>,<span class="st">"orange1"</span>), <span class="co"># color</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">las=</span><span class="dv">1</span>,  <span class="co"># cambia la inclinación de los números de eje</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>)) <span class="co"># establece los límites del eje y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Todo lo que creamos con la función se denominan parámetros primarios del gráfico. Luego se le pueden modificar parámetros secundarios como</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> Pb,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> HOJA,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># aquí agregamos los parámetros secundarios</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab=</span> <span class="st">"Pb"</span>, <span class="at">line =</span> <span class="fl">2.5</span>) <span class="co"># título del eje eligiendo la distancia</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># línea horizontal</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">25</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># línea vertical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="función-ggplot-paquete-ggplot2" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="función-ggplot-paquete-ggplot2"><span class="header-section-number">2.4.3</span> Función ggplot (paquete ggplot2)</h3>
<p>Finalmente introduciremos el paquete gráfico <strong>ggplot2</strong>. Si bien es un poco más complicado de aprender y cada gráfico puede requerirnos más tiempo, es súper versátil y permite hacer infinidad de cosas. La lógica de trabajo es un poco diferente a las anteriores, ya que aquí se trabaja en capas que se van separando por el signo +. Todo lo que veamos en este apartado se aplica a casi cualquier tipo de gráfico con <code>ggplot</code>, por lo que nos servirá también para variables categóricas.</p>
<p><strong>ggplot2</strong> maneja una composición por capas. En la primera capa debemos especificar primero la base de datos a utilizar, y luego el <em>aesthetic</em>, es decir, la estructura que tendrán nuestros datos. En una segunda capa elegiremos el <em>geom</em> que dirá la forma que tomará nuestro gráfico. Con estas capas mínimas podemos obtener un gráfico.</p>
<p>Por ejemplo creamos el gráfico de puntos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>G1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> HOJA, <span class="co"># el data set</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> SPAD, <span class="at">y =</span> Pb)) <span class="sc">+</span> <span class="co"># x e y dentro de aes</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="co"># indica que el gráfico es de puntos</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>G1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A partir de acá, podemos ir agregando en sucesivas líneas y separados por signo + las características que queramos modificar. Por ejemplo, podemos cambiar el tema general del gráfico (veremos mucho más detalle más adelante) o modificar el aspecto de los puntos dentro del <em>geom</em>:</p>
<div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA, <span class="fu">aes</span>(SPAD, Pb)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA, <span class="fu">aes</span>(SPAD, Pb)) <span class="sc">+</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"yellow"</span>) <span class="sc">+</span>  <span class="co"># cambiamos tamaño y color</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<p>Podemos agregar nuevas capas con otros <em>geoms</em> al mismo gráfico. Así se puede agregar una línea que una los puntos (con un <em>geom_line</em>) o una línea de regresión con su intervalo de confianza (<strong>geom_smooth</strong>). Es importante mencionar que el orden en el que incluyamos las capas afecta al resultado, la última aparecerá más arriba:</p>
<div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>G1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">"deeppink3"</span>) <span class="co"># cambiamos el color en los parámetros del geom</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>G1 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<p>Al igual que hicimos con <code>lineplot.CI</code>, podemos agrupar los datos por algún factor según alguna característica que elijamos (color, forma, relleno, tamaño, etc.). Por ejemplo si queremos distinguir los puntos por color según el estrés térmico:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(HOJA,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(SPAD, Pb,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> ET)) <span class="sc">+</span> <span class="co"># agregamos en el aes por qué parámetro dividir</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>G2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ahora si queremos graficar la variable discreta donde para cada valor del eje <em>x</em> tenemos varios valores de <em>y</em>, por defecto <em>geom_point</em> grafica los puntos individualizados, a diferencia de lo que hacía <em>lineplot.CI</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA, <span class="fu">aes</span>(SPAD_cat, Pb)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Entonces para graficar la media y el error estándar, incluimos una capa de <em>stat</em>, que realiza cálculos con la variable respuesta. En este caso, <strong>stat_summary</strong> nos permite graficar el valor medio:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> HOJA,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(SPAD_cat, Pb))<span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span>mean_se, <span class="at">geom =</span><span class="st">'errorbar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># podemos mejorar un poco la estética</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> HOJA,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(SPAD_cat, Pb))<span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">col =</span> <span class="st">"azure4"</span>) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span>mean_se, <span class="at">geom =</span><span class="st">'errorbar'</span>, <span class="at">width=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="actividad-3" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="actividad-3"><span class="header-section-number">2.4.4</span> Actividad 3</h3>
<ol type="1">
<li>Realice una representación gráfica del modelo de regresión realizado en la actividad 2. Incorpore en la gráfica una clasificación por estrés térmico por color.</li>
</ol>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>
</section>
<section id="unidad-3.-análisis-y-representación-de-datos-categóricos" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Unidad 3. Análisis y representación de datos categóricos</h1>
<section id="anova-a-1-factor" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="anova-a-1-factor"><span class="header-section-number">3.1</span> ANOVA a 1 factor</h2>
<p>Ahora vamos a trabajar con los datos con variables categóricas. Cuando incorporamos un factor con diferentes niveles y nos interesa comparar si hay diferencias entre los efectos de los distintos niveles de uno o más factores uno de los análisis más utilizados es el análisis de la varianza. Comenzaremos con el caso de un único factor.</p>
<p>Este análisis plantea la comparación de medias muestrales a partir de la varianza que presentan los datos dentro de cada grupo (de allí su nombre). Al igual que el modelo de regresión, presenta supuestos a cumplirse (normalidad de la variable y homogeneidad de las varianzas).</p>
<p>El planteo del modelo en R será de la misma manera que la regresión, ya que se trata de otro modelo lineal. En nuestro ejemplo trabajaremos evaluando el efecto del estrés térmico (inicialmente) en el peso seco de semillas de la variedad Alim 3,14. Para ello armaremos la base de datos (doy como ejemplo algunas formas de armarla en base a las que ya tenemos):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="ot">&lt;-</span> SEM <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GT <span class="sc">==</span> <span class="st">"Alim 3,14"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="ot">&lt;-</span> ALIM <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organo <span class="sc">==</span> <span class="st">"Semilla"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="ot">&lt;-</span> ALIM_VyS <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organo <span class="sc">==</span> <span class="st">"Semilla"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="ot">&lt;-</span> ALIM_VyS <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organo <span class="sc">!=</span> <span class="st">"Vaina"</span>) <span class="co"># signo diferente a</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y ahora sí corremos el modelo y ponemos a prueba los supuestos de igual manera que hiciéramos anteriormente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span><span class="fu">lm</span>(PS <span class="sc">~</span> ET, <span class="at">data =</span> SEM_Alim)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de supuestos</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)); <span class="fu">plot</span>(fit3) ;<span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(fit3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(fit3)
W = 0.92632, p-value = 0.3428</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">resid</span>(fit3)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>ET) <span class="co"># no hay homogeneidad</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  resid(fit3) by SEM_Alim$ET
Bartlett's K-squared = 8.139, df = 1, p-value = 0.004332</code></pre>
</div>
</div>
<p>Como vemos hay normalidad de errores pero no homogeneidad de varianza. Si bien esto pudiera no ser un problema muy grande (el modelo sobreestimará la varianza general y tendrá menos potencia), podemos transformar la variable respuesta:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probamos transformando por el logaritmo</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(PS) <span class="sc">~</span> ET, <span class="at">data =</span> SEM_Alim)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)); <span class="fu">plot</span>(fit3) ;<span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(fit3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(fit3)
W = 0.91186, p-value = 0.2254</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">resid</span>(fit3)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>ET)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  resid(fit3) by SEM_Alim$ET
Bartlett's K-squared = 0.41623, df = 1, p-value = 0.5188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(fit3,<span class="at">type=</span><span class="st">"pearson"</span>)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>ET,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Pearson standarized residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ahora sí se cumple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entonces ahora que ya sabemos de la validez del modelo, pediremos la tabla del ANOVA para ver si existen o no diferencias significativas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log(PS)
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
ET         1 5.5709  5.5709  26.502 0.0004327 ***
Residuals 10 2.1020  0.2102                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Vemos que arroja un p mucho menor a 0,05, por lo que diremos que al menos una media es diferente de las otras (como en este caso son dos niveles, una de la otra). Para saber cuál es diferente de cuál, como test a posteriori podemos correr el test de Tukey. Para ello utilizamos la función <code>HSD.test</code> del paquete <strong>agricolae</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>tukey1 <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fit3,<span class="st">"ET"</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>tukey1<span class="sc">$</span>groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     log(PS) groups
No 2.0346143      a
Si 0.6719101      b</code></pre>
</div>
</div>
<p>Vemos que sin estrés térmico las semillas tenían mayor peso seco.</p>
</section>
<section id="anova-bifactorial" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="anova-bifactorial"><span class="header-section-number">3.2</span> ANOVA bifactorial</h2>
<p>Para correr un modelo de ANOVA con 2 factores diferentes y evaluar su interacción debemos poner ambas variables separadas por *. Analizaremos el mismo modelo de antes pero incorporando además el efecto del CO<sub>2</sub> atmosférico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>SEM_Alim<span class="sc">$</span>CO2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(SEM_Alim<span class="sc">$</span>CO2) <span class="co"># convertimos a factor</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span><span class="fu">lm</span>(PS <span class="sc">~</span> ET<span class="sc">*</span>CO2, <span class="at">data =</span> SEM_Alim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De la misma manera que antes, probamos los supuestos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de supuestos</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)); <span class="fu">plot</span>(fit4) ;<span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la homogeneidad se prueba para cada factor</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">resid</span>(fit4)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>ET)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">resid</span>(fit4)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>CO2)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(fit4,<span class="at">type=</span><span class="st">"pearson"</span>)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>ET,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Pearson standarized residuals"</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(fit4,<span class="at">type=</span><span class="st">"pearson"</span>)<span class="sc">~</span>SEM_Alim<span class="sc">$</span>CO2,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Pearson standarized residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
    Bartlett test of homogeneity of variances

data:  resid(fit4) by SEM_Alim$ET
Bartlett's K-squared = 7.6109, df = 1, p-value = 0.005802</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
    Bartlett test of homogeneity of variances

data:  resid(fit4) by SEM_Alim$CO2
Bartlett's K-squared = 4.1568, df = 1, p-value = 0.04147</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<p>Una vez comprobados los supuestos, para ver los resultados debemos ejecutar el comando anova. También podemos ejecutar el summary, que nos permitirá ver contrastes con respecto al primer nivel del factor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tablas</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: PS
          Df Sum Sq Mean Sq F value   Pr(&gt;F)   
ET         1 121.73 121.731 23.9217 0.001207 **
CO2        1   8.30   8.300  1.6311 0.237373   
ET:CO2     1  17.91  17.910  3.5195 0.097500 . 
Residuals  8  40.71   5.089                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PS ~ ET * CO2, data = SEM_Alim)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9033 -0.8675 -0.1083  0.5008  4.7767 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    6.393      1.302   4.909  0.00118 **
ETSi          -3.927      1.842  -2.132  0.06560 . 
CO2550         4.107      1.842   2.230  0.05633 . 
ETSi:CO2550   -4.887      2.605  -1.876  0.09750 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.256 on 8 degrees of freedom
Multiple R-squared:  0.7842,    Adjusted R-squared:  0.7033 
F-statistic: 9.691 on 3 and 8 DF,  p-value: 0.004853</code></pre>
</div>
</div>
<p>Vemos que el resultado del ANOVA es significativo únicamente para el factor ET, por lo que el modelo correcto sería el unifactorial. Sin embargo mostraremos los test a posteriori para el caso bifactorial:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>tukey1 <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fit4,<span class="st">"ET"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>tukey1<span class="sc">$</span>groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         PS groups
No 8.446667      a
Si 2.076667      b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>tukey2 <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fit4,<span class="st">"CO2"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>tukey2<span class="sc">$</span>groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          PS groups
550 6.093333      a
400 4.430000      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>tukey3 <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fit4,<span class="fu">c</span>(<span class="st">"ET"</span>,<span class="st">"CO2"</span>))</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>tukey3<span class="sc">$</span>groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              PS groups
No:550 10.500000      a
No:400  6.393333     ab
Si:400  2.466667      b
Si:550  1.686667      b</code></pre>
</div>
</div>
</section>
<section id="actividad-4" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="actividad-4"><span class="header-section-number">3.3</span> Actividad 4</h2>
<p>Realice un ANOVA bifactorial con los factores ET y CO2 pero para el peso seco de semillas de los cultivares ES Mentor y Sigalia. ¿Se observa la misma respuesta que para el cultivar Alim 3,14?</p>
</section>
<section id="gráficos-de-barras" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="gráficos-de-barras"><span class="header-section-number">3.4</span> Gráficos de barras</h2>
<p>Nuevamente, veremos varias formas de hacerlos empleando tanto <strong>sciplot</strong> como <strong>ggplot2</strong>.</p>
<section id="bargraph.ci-sciplot" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="bargraph.ci-sciplot"><span class="header-section-number">3.4.1</span> bargraph.CI (sciplot)</h3>
<p>Al igual que para los gráficos de puntos, el paquete <strong>sciplot</strong> nos brinda una función para realizar rápidamente un gráfico de barras, sin necesidad de ejecutar ningún cálculo previo. Por ejemplo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bargraph.CI</span>(<span class="at">x.factor =</span> ET, <span class="at">response =</span> PS, <span class="at">group =</span> CO2,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>), <span class="at">legend =</span> T,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> SEM_Alim,  <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"honeydew"</span>,<span class="st">"honeydew4"</span>),</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">las=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">"Estrés térmico"</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ylab=</span> <span class="st">"Peso seco"</span>,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex.axis=</span><span class="fl">0.8</span>);<span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Los parámetros a modificar son los mismos que vimos anteriormente para los gráficos de puntos.</p>
</section>
<section id="geom_col-ggplot2" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="geom_col-ggplot2"><span class="header-section-number">3.4.2</span> geom_col (ggplot2)</h3>
<p><strong>Ggplot2</strong> nos ofrece dos geoms para hacer gráficos de barras (<code>geom_col</code> y <code>geom_bar</code>). Utilizaremos en este taller únicamente geom_col.</p>
<p>Un inconveniente al realizar estos gráficos, es que por defecto el geom no nos calcula la media y los desvíos de la variable a graficar, sino que nos representa directamente los datos que le demos. Sin embargo, una de las principales virtudes de <code>ggplot</code> y del entorno <strong>tidyverse</strong> es la posibilidad realizar todos los cambios que creamos convenientes a nuestro database y luego graficar la base modificada sin necesidad de haber creado explícitamente un objeto nuevo. ¿Qué ventaja presenta esto? Nos permite manipular fácilmente la base de datos sin crear una lista muy larga de objetos que luego se nos complique identificar cuál es cuál. Así, a modo de ejemplo,</p>
<p>Entonces, para realizar el mismo gráfico que hicimos con <code>bargraph.CI</code>, debemos calcular la media y el error estándar de la variable PS de semillas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="sc">%&gt;%</span> <span class="fu">select</span>(CO2, ET, PS) <span class="sc">%&gt;%</span> <span class="co"># seleccionamos las columnas involucradas</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CO2, ET) <span class="sc">%&gt;%</span> <span class="co"># definimos criterios de agrupamiento</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">list</span>(mean,se)) <span class="co"># pedimos media y error estándar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   CO2 [2]
  CO2   ET      fn1   fn2
  &lt;fct&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 400   No     6.39 2.41 
2 400   Si     2.47 0.476
3 550   No    10.5  0.811
4 550   Si     1.69 0.329</code></pre>
</div>
</div>
<p>Vemos que incorpora las columnas <em>fn1</em> (que tiene los valores de las medias) y <em>fn2</em> (con los errores estándares). A estos comandos creados se les anexa el gráfico:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>SEM_Alim <span class="sc">%&gt;%</span> <span class="fu">select</span>(CO2, ET, PS) <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CO2, ET) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">list</span>(mean,se)) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ET, fn1, </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span>CO2))<span class="sc">+</span> <span class="co"># en este caso el parámetro de color lo define fill</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como vemos, la barras se apilan. Para que vaya una al lado de la otra, debemos cambiar el parámetro <em>position= “dodge”</em> dentro del geom (por defecto está en <em>identity</em>). Además agregaremos las barras de error:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">&lt;-</span> SEM_Alim <span class="sc">%&gt;%</span> <span class="fu">select</span>(CO2, ET, PS) <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CO2, ET) <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">list</span>(mean,se)) <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ET, fn1, <span class="at">fill=</span>CO2))<span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>fn1<span class="sc">-</span>fn2, <span class="at">ymax=</span>fn1<span class="sc">+</span>fn2), <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>))</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>G3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Una alternativa para no tener que realizar manualmente la transformación de la base de datos cuando queremos graficar medias y desvíos es usar <code>stat_summary</code>. Esta función tiene una nomenclatura algo distinta a las otras y permite especificar diferentes geoms. Veamos para realizar el último gráfico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SEM_Alim, <span class="fu">aes</span>(ET, PS, <span class="at">fill=</span>CO2))<span class="sc">+</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"col"</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span>mean_se, <span class="at">geom =</span><span class="st">'errorbar'</span>, <span class="at">width=</span><span class="fl">0.2</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sin embargo, si queremos agregar las letras del Tukey realizado, será más adecuado hacerlo con el cálculo previo de medias y error estándar. Esto es así ya que nos permite ubicar adecuadamente las letras en la altura correspondiente a cada columna. Las letras las incorporaremos de forma manual con un nuevo geom, el <em>geom_text</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> fn1 <span class="sc">+</span> fn2,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span> <span class="fu">c</span>(<span class="st">"ab"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>)),</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust=</span><span class="sc">-</span>.<span class="dv">5</span>) <span class="co"># ajuste vertical de la posición</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-barras-apiladas-y-apilado-porcentual" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="gráfico-de-barras-apiladas-y-apilado-porcentual"><span class="header-section-number">3.4.3</span> Gráfico de barras apiladas y apilado porcentual</h3>
<p>Veremos ahora cómo realizar un gráfico de barras apilado y un apilado porcentual. Supongamos como ejemplo que queremos graficar el peso seco de los órganos evaluados en plantas de soja de la variedad Alim 3,14. Para ello, lo primero que debemos hacer es “ordenar” los niveles del factor como los queramos mostrar. En nuestro caso, iremos de abajo hacia arriba de la planta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>ALIM<span class="sc">$</span>Organo <span class="ot">&lt;-</span> <span class="fu">factor</span>(ALIM<span class="sc">$</span>Organo, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Tallo"</span>,<span class="st">"Hoja"</span>,<span class="st">"Vaina"</span>,<span class="st">"Semilla"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez hecho esto, vamos a transformar nuestra base de datos utilizando la función <code>ddply</code>del paquete <strong>plyr</strong>. Esta función tiene un uso particular que excede el contenido de este curso, veremos simplemente cómo utilizarla con el ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>ALIM_apilado <span class="ot">&lt;-</span> ALIM <span class="sc">%&gt;%</span> <span class="fu">select</span>(Organo, ET, PS) <span class="sc">%&gt;%</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ET, Organo) <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">funs</span>(mean,se)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ddply</span>(<span class="fu">c</span>(<span class="st">"ET"</span>), transform,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent_PS =</span>  mean<span class="sc">/</span> <span class="fu">sum</span>(mean) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ddply</span>(<span class="fu">c</span>(<span class="st">"ET"</span>), transform, <span class="at">label_y=</span><span class="fu">cumsum</span>(mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ddply</span>(<span class="fu">c</span>(<span class="st">"ET"</span>), transform, <span class="at">label_y_perc=</span><span class="fu">cumsum</span>(percent_PS)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Organo=</span><span class="fu">factor</span>(Organo, </span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Semilla"</span>, <span class="st">"Vaina"</span>,</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Hoja"</span>, <span class="st">"Tallo"</span>)))</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="co"># notar que volvemos a invertir el orden  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ET</th>
<th style="text-align: left;">Organo</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">se</th>
<th style="text-align: right;">percent_PS</th>
<th style="text-align: right;">label_y</th>
<th style="text-align: right;">label_y_perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Tallo</td>
<td style="text-align: right;">4.680000</td>
<td style="text-align: right;">0.5586889</td>
<td style="text-align: right;">17.18587</td>
<td style="text-align: right;">4.68000</td>
<td style="text-align: right;">17.18587</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Hoja</td>
<td style="text-align: right;">9.740000</td>
<td style="text-align: right;">0.9862048</td>
<td style="text-align: right;">35.76718</td>
<td style="text-align: right;">14.42000</td>
<td style="text-align: right;">52.95306</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Vaina</td>
<td style="text-align: right;">4.365000</td>
<td style="text-align: right;">0.7491584</td>
<td style="text-align: right;">16.02913</td>
<td style="text-align: right;">18.78500</td>
<td style="text-align: right;">68.98219</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Semilla</td>
<td style="text-align: right;">8.446667</td>
<td style="text-align: right;">1.4605996</td>
<td style="text-align: right;">31.01781</td>
<td style="text-align: right;">27.23167</td>
<td style="text-align: right;">100.00000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Como se puede ver, además de calcular media y error estándar, se crearon las variables label_y (que nos da el acumulado parcial, nos servirá como posición para poner una etiqueta) y label_y_perc para el acumulado porcentual. Ahora podemos ejecutar los gráficos y agregar además el valor de cada columna apilada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>G4 <span class="ot">&lt;-</span> ALIM_apilado <span class="sc">%&gt;%</span>   </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(ET, mean, <span class="at">fill=</span>Organo))<span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(mean, <span class="dv">2</span>), <span class="co"># agregamos el valor</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> label_y))  <span class="co"># indica la posición</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>G4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>G5 <span class="ot">&lt;-</span> ALIM_apilado <span class="sc">%&gt;%</span>   </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ET, percent_PS, <span class="at">fill=</span>Organo))<span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(percent_PS, <span class="dv">2</span>), <span class="at">y =</span> label_y_perc), <span class="at">vjust=</span><span class="dv">2</span>)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>G5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-71-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="boxplot" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">3.5</span> Boxplot</h2>
<p>Los gráficos tipo boxplot también son formas frecuentes de presentar variables numéricas con distintos factores de clasificación. Veremos algunas formas de hacerlo.</p>
<section id="función-boxplot" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="función-boxplot"><span class="header-section-number">3.5.1</span> Función boxplot</h3>
<p>La función derivada de <code>plot</code> para hacer gráficos de barras es <code>boxplot</code>. Se utiliza de forma similar a los gráficos ya vistos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(PS<span class="sc">~</span>ET, <span class="at">data =</span> SEM_Alim,</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Estrés térmico"</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Peso seco"</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="geom_boxplot" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="geom_boxplot"><span class="header-section-number">3.5.2</span> geom_boxplot</h3>
<p>El paquete <strong>ggplot2</strong> nos ofrece una vez maś una forma muy versátil de crear gráficos de cajas. La función en cuestión es <code>geom_boxplot</code> que, a diferencias de <code>geom_col</code>, no requiere que realicemos ningún cálculo previo. De esta manera podemos generar un gráfico con un par de líneas de código:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SEM_Alim, <span class="fu">aes</span>(ET, PS))<span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si vemos con atención a este gráfico le faltan una serie de cosas que podrían mejorarlo. Por un lado, los extremos de los cuartiles no tienen la marca de final, sino que simplemente termina la línea. Sumado a esto, podría interesarnos agregar el valor de la media, que no figura en el gráfico. Veamos como incorporarlos con la función ya vista <code>stat_summary</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SEM_Alim, <span class="fu">aes</span>(ET, PS))<span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span><span class="st">'errorbar'</span>, <span class="at">width=</span><span class="fl">0.2</span>)<span class="sc">+</span> <span class="co">#debemos colocarlo primero para que quede al fondo</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="actividad-5" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="actividad-5"><span class="header-section-number">3.6</span> Actividad 5</h2>
<p>Realice un gráfico de barras y un gráfico de cajas donde demuestre los resultados de los ANOVA realizados en la actividad 4.</p>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>
<section id="unidad-4.-estructura-y-estética-de-gráficos-con-ggplot2." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Unidad 4. Estructura y estética de gráficos con ggplot2.</h1>
<p>En esta unidad veremos una serie de contenidos relacionados con parámetros estructurales del gráfico (como las escalas, la división de la ventana gráfica, etc.) y estéticos que van desde la paleta de colores utilizada hasta el tema general.</p>
<p>Sin embargo, empezaremos viendo cómo exportar un gráfico para luego poder ir extrayendo los que iremos generando.</p>
<section id="exportación-de-resultados-y-gráficos" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="exportación-de-resultados-y-gráficos"><span class="header-section-number">4.1</span> Exportación de resultados y gráficos</h2>
<section id="exportación-de-datos" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="exportación-de-datos"><span class="header-section-number">4.1.1</span> Exportación de datos</h3>
<p>A este respecto, en mi práctica personal suelo leer los resultados desde la consola de R y, de ser necesario, realizo el pasaje manualmente de la información que me resulte de interés a un excel para su almacenamiento. De todas maneras, existen maneras de exportar diferentes formatos de archivos desde R. Cuando lo considero necesario, utilizo archivos del tipo csv. Así por ejemplo para exportar los datos de una regresión:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>REG <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit1) <span class="co"># creamos un objeto para poder después extraer los coeficientes</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(REG<span class="sc">$</span>coefficients, <span class="st">"regresión prueba.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como vemos, debo tener una tabla limpia y luego agregar el nombre y formato del archivo a crear. Lo mismo si quisiera extraer la tabla de un anova o un tukey:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(<span class="fu">anova</span>(fit3), <span class="st">"anova prueba.csv"</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(tukey3<span class="sc">$</span>groups, <span class="st">"tukey prueba2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por supuesto, todo lo que exportemos se guardará en el directorio seteado al comienzo con setwd().</p>
</section>
<section id="exportación-de-gráficos" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="exportación-de-gráficos"><span class="header-section-number">4.1.2</span> Exportación de gráficos</h3>
<p>Este apartado es mucho más útil que el anterior y nos va a permitir extraer nuestras figuras que hayamos creado de una forma adecuada. Veremos 3 formas de exportar un gráfico.</p>
<section id="interfaz-gráfica-de-rstudio" class="level4" data-number="4.1.2.1">
<h4 data-number="4.1.2.1" class="anchored" data-anchor-id="interfaz-gráfica-de-rstudio"><span class="header-section-number">4.1.2.1</span> Interfaz gráfica de RStudio</h4>
<p>En la ventana 4 de RStudio se nos muestran los gráficos que hayamos generado. En la barra superior de esa ventana (siempre que estemos en la pestaña <em>Plots</em>) veremos la opción de <em>Export</em>. Si allí entramos en <em>Save as image</em> nos brinda una serie de opciones de exportación. Menciono esta posibilidad porque en algunos contextos puede sernos de utilidad. Como siempre que utilizamos la interfaz gráfica, esta tiene la desventaja de no nos deja ningún tipo de registro de lo que hayamos hecho, lo que no nos permite repetir la exportación en igualdad de condiciones, si es que fuera necesario.</p>
</section>
<section id="devices" class="level4" data-number="4.1.2.2">
<h4 data-number="4.1.2.2" class="anchored" data-anchor-id="devices"><span class="header-section-number">4.1.2.2</span> Devices</h4>
<p>Una segunda opción es el uso de Devices. Esta opción consiste en un código inicial donde definimos el formato, luego el gráfico y finalmente el cierre. Así por ejemplo para exportar un jpg:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">file =</span> <span class="st">"mi_grafico.jpg"</span>,</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="co">#ancho y alto</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">quality =</span> <span class="dv">95</span>, <span class="co">#grado de no-compresión</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">res =</span> <span class="dv">300</span>) <span class="co">#resolución en puntos por pulgada</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(PS<span class="sc">~</span>ET,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> SEM_Alim) <span class="co"># comandos gráficos</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co"># cerrar el gráfico</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>También es posible exportar en PDF, SVG (formato vectorizado), y otros. Es recomendable pintar todo el texto (inicio + gráfico + cierre) y luego ejecutar todo como una única corrida.</p>
</section>
<section id="ggsave" class="level4" data-number="4.1.2.3">
<h4 data-number="4.1.2.3" class="anchored" data-anchor-id="ggsave"><span class="header-section-number">4.1.2.3</span> ggsave</h4>
<p>Esta es una opción interna dentro del entorno de <strong>ggplot2</strong>. Se debe ejecutar a continuación y luego de haber corrido el gráfico. Su estructura es la siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"mi gráfico.png"</span>, <span class="co"># nombre y formato</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>, <span class="co"># ancho y alto, si no especificamos se ve tal cual en la ventana 4</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>) <span class="co"># resolución</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si se quiere exportar en formato SVG, es necesaria la instalación del paquete <em>svglite</em>.</p>
</section>
</section>
</section>
<section id="títulos" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="títulos"><span class="header-section-number">4.2</span> Títulos</h2>
<p>Para modificar los títulos de nuestros gráficos utilizaremos el parámetro <em>labs</em>. Allí modificaremos la etiqueta de cada eje, de la leyenda, y posibles títulos del gráfico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">&lt;-</span> G3 <span class="sc">+</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Estrés térmico"</span>, </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Peso seco (g)"</span>, </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">expression</span>(CO[<span class="dv">2</span>]), <span class="co"># cambia la leyenda</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Peso seco de semillas de soja"</span>) ; G3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scales" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="scales"><span class="header-section-number">4.3</span> Scales</h2>
<section id="manipulando-los-ejes" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="manipulando-los-ejes"><span class="header-section-number">4.3.1</span> Manipulando los ejes</h3>
<p>Podemos establecer la estructura de nuestros ejes a partir de los comandos <code>scale_x_***</code> donde en debemos indicar el tipo de dato de nuestro eje (todo esto es válido tanto para el eje <em>x</em> como el <em>y</em>). Así dependiendo del tipo de variable, serán los datos a modificar. Por ejemplo si la variable es continua:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>  ... <span class="sc">+</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuos</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># estable la ubicación en el eje</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits=</span><span class="fu">c</span>(inferior,superior), <span class="co"># entre qué valores se graficará</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="fu">seq</span>(inferior,superior, <span class="co"># entre qué valores se mostrará la escala</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">by =</span> número)) <span class="co"># cada cuánto habrá cortes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Es importante destacar que el parámetro <em>limits</em> establece los límites del gráfico y los valores que se tomarán en cuenta. Si algo de nuestros datos excede ese valor, no será considerado para el gráfico. Si en cambio queremos tomar en cuenta todos los datos pero hacer un recorte en el gráfico, debemos usar el comando <code>coord_cartesian(ylim=c(inferior,superior))</code> en una nueva línea.</p>
<p>En el caso de querer modificar los nombres que aparecen en el eje (habitualmente para variables discretas o categóricas) usaremos el comando <code>labels</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(etiqueta1, etiqueta2, ...))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Continuando con nuestro ejemplo en el G3, comparemos con y sin manipulación de ejes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>G3</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">&lt;-</span> G3 <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sin ET"</span>, <span class="st">"Con ET"</span>)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>, <span class="at">by=</span> <span class="dv">1</span>)); G3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-82-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
<section id="colores" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="colores"><span class="header-section-number">4.3.2</span> Colores</h3>
<p>R permite la utilización de una gran cantidad de colores diferentes (ver documento <em>ColorChart</em>). Se pueden modificar los colores de casi todos los objetos en un gráfico, aquí nos centraremos en contornos y rellenos de nuestros elementos que representan los datos. Como regla general, si nuestro geom admite relleno este se modifica con el parámetro <em>fill</em>, mientras que <em>col</em> modificará el borde. Si no se admite relleno (gráficos de líneas o puntos), solo utilizaremos <em>col</em>. Cómo modificamos los colores varía un poco según diferentes casos:</p>
<ul>
<li><p>Si el color es el mismo para todos, se modifica dentro de los parámetros del geom. Por ejemplo: <code>geom_col(col= "black", fill= "red")</code>.</p></li>
<li><p>Si debemos modificar el color o el relleno según un criterio de clasificación (es decir que seteamos el parámetro que clasifica en el aes()) usaremos el comando <code>scale_colour_manual(values=c("color1", "color2", ....))</code> para establecer manualmente los colores. Lo mismo para el relleno pero será <code>scale_fill_manual(values=c("color1", "color2", ....))</code>. Es importante destacar que la cantidad de colores debe coincidir con los niveles del factor en cuestión.</p></li>
</ul>
<p>Veamos un ejemplo donde combinamos lo visto hasta ahora:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># repetimos para cambiar el borde</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"skyblue3"</span>, <span class="st">"antiquewhite2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>En estos casos decidimos establecer manualmente el color. También podemos utilizar paletas de colores que vienen preestablecidas. Algunas están con el R base y otras debemos cargarlas con paquetes. En este taller veremos el uso de la paleta <strong>viridis</strong>, de paquete homónimo. La función que utilizaremos es <code>scale_fill_viridis_d()</code>, donde la “d” refiere a discreto. Esta escala está especialmente diseñada para que la puedan distinguir personas daltónicas y asignará tantos colores como sean necesarios. La escala viridis va del violeta al amarillo, podemos reducir la escala estableciendo el comienzo y el final de la misma. Por otro lado, también veremos el uso del paquete <em>paletteer</em>, que incluye una enorme cantidad de paletas para utilizar (https://r-charts.com/es/paletas-colores/). Por ejemplo en el gráfico anterior:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paletteer)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">paletteer_d</span>(<span class="st">"colorBlindness::Blue2DarkOrange12Steps"</span>, <span class="dv">2</span>, </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">type =</span> <span class="st">"continuous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-84-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Si queremos saber exactamente qué colores utilizó la función, podemos utilizar la función <code>viridis</code> para nombrar los colores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">viridis</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#440154FF" "#FDE725FF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paletteer_d</span>(<span class="st">"colorBlindness::Blue2DarkOrange12Steps"</span>, <span class="dv">2</span>, </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">type =</span> <span class="st">"continuous"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;colors&gt;
#1E8E99FF #993F00FF </code></pre>
</div>
</div>
<p>Nos los da con el código RGB que podemos utilizar para otros gráficos.</p>
</section>
<section id="forma-y-tipo-de-línea" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="forma-y-tipo-de-línea"><span class="header-section-number">4.3.3</span> Forma y tipo de línea</h3>
<p>Otro parámetro que puede generar diferencias entre los niveles de una factor o que puede ser modificado para todos nuestros valores es la forma. Para indicar el cambio se hará del mismo modo que para el color o relleno, pero con el parámetro <code>shape</code>. Las diferentes formas se pueden visualizar en el documento Refcard, son 25 y algunas permiten que se les modifique el relleno. La forma puede ser combinada por el color para enfatizar las diferencias, y originarán una sola leyenda, por ejemplo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA,</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(SPAD, Pb,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> ET,  <span class="co"># clasificamos por color</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> ET)) <span class="sc">+</span> <span class="co"># y por forma</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A su vez podemos establecer tipos de líneas en un gráfico de líneas. Funciona de la misma manera con el parámetro <code>linetype</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(SPAD, Pb,</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> ET,</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> ET,</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> ET)) <span class="sc">+</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">18</span>)) <span class="sc">+</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">"Estrés </span><span class="sc">\n</span><span class="st">térmico"</span>, </span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Estrés </span><span class="sc">\n</span><span class="st">térmico"</span>, </span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Estrés </span><span class="sc">\n</span><span class="st">térmico"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como vemos, como todos los parámetros de clasificación responden al mismo factor, la leyenda es una sola. Para modificar el título de la leyenda se debe indicar el cambio para todos los parámetros involucrados.</p>
<p>También se puede clasificar por tamaño en el caso de una variable continua, generará una escala automática.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOJA,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(SPAD, Pb,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> Pb, <span class="co"># genera una escala discreta de tamaños </span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> Pb)) <span class="sc">+</span> <span class="co"># genera una escala continua de color</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="subdivisión-del-gráfico-con-faceting" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="subdivisión-del-gráfico-con-faceting"><span class="header-section-number">4.4</span> Subdivisión del gráfico con faceting</h2>
<p>Si nuestro gráfico requiere la subdivisión por varios factores, además de por colores podemos dividir la ventana con faceting. El parámetro facet_grid requiere que introduzcamos por cuál/es variable/s se dividirá, por lo tanto toma la forma var1~var2, si solo hay una se reemplaza la faltante por un punto (.). Es importante destacar que todas las divisiones responderán a la misma escala. Así por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>GT) <span class="co"># para dividir verticalmente</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="sc">+</span> <span class="fu">facet_grid</span>(GT<span class="sc">~</span>.) <span class="co"># para dividir horizontalmente</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="sc">+</span> <span class="fu">facet_grid</span>(CO2<span class="sc">~</span>GT) <span class="co"># para dividir por ambas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-89-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="multifaceting" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="multifaceting"><span class="header-section-number">4.4.1</span> Multifaceting</h3>
<p>Si quisiéramos definir más de un nivel de división, podemos utilizar la función <code>facet_nested</code> del paquete <em>ggh4x</em>. Por ejemplo de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggh4x' was built under R version 4.4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="sc">+</span> <span class="fu">facet_nested</span>(.<span class="sc">~</span>GT<span class="sc">+</span>CO2) <span class="co"># cada nivel de GT se divide por CO2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="definiendo-la-estética-de-nuestros-gráficos" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="definiendo-la-estética-de-nuestros-gráficos"><span class="header-section-number">4.5</span> Definiendo la estética de nuestros gráficos</h2>
<section id="exportación-y-edición-posterior-un-arma-de-doble-filo" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="exportación-y-edición-posterior-un-arma-de-doble-filo"><span class="header-section-number">4.5.1</span> Exportación y edición posterior: un arma de doble filo</h3>
<p>La posibilidad de exportar un gráfico y editarlo posteriormente en otro software siempre está sobre la mesa. Este apartado tiene como idea presentar y analizar brevemente sus ventajas y desventajas.</p>
<p>En este caso la que más he utilizado y funciona muy bien es el uso de imágenes vectorizadas. Si exportamos un archivo en formato svg, el mismo podrá verse en esta forma en software de edición de imagen. El que yo recomiendo es Inkscape, ya que es gratuito y multiplataforma y su forma de uso es muy intuitivo. La ventaja de tener la imagen vectorizada es que no perdemos calidad y además nos brinda la posibilidad de manipular cada uno de los elementos del gráfico individualmente.</p>
<p>El manejo externo de los gráficos es una herramienta muy poderosa en cuanto a las posibilidades que nos ofrece, ya que podemos modificar lo que queramos a nuestro antojo y con muy buenos resultados. Sin embargo, tiene una desventaja enorme: nuestra edición no es repetible. Esto quiere decir, que si por algún motivo tuvimos que hacer el gráfico de nuevo, todo el trabajo de edición empieza de cero. Y, al menos en mi experiencia de trabajo, rehacer un gráfico ya hecho es cosa de todos los días (decidimos incluir o no un outlier, corregimos datos, modificamos un factor, cambiamos de idioma el gráfico, etc.).</p>
<p>Por estos motivos, mi recomendación es intentar hacer lo más posible directamente en R y solo en casos de extrema necesidad acudir al software externo. A pesar de esto, no deja de ser una herramienta potente y a tener en cuenta.</p>
</section>
<section id="definiendo-el-theme-en-ggplot2" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="definiendo-el-theme-en-ggplot2"><span class="header-section-number">4.5.2</span> Definiendo el <code>theme</code> en ggplot2</h3>
<p>Cuando realizamos un gráfico con <code>ggplot</code> la mayor parte de las cuestiones estéticas se definen dentro del parámetro <code>theme</code>. Este apartado nos permite modificar las letras del gráficos en general, de los ejes, de los títulos de los ejes, la posición y estructura de la leyenda, etc. La estructura general consiste en nombrar el elemento a modificar, luego establecer el tipo de elemento, y finalmente modificar los parámetros. Supongamos a modo de ejemplo que queremos que las etiquetas del eje <em>x</em> estén en negro, con tamaño de letra 12, con inclinación vertical. Entonces escribiremos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>Gráfico <span class="sc">+</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span> ,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle=</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos ir separando por comas diferentes elementos que queramos modificar. Otra opción interesante es crear un objeto con todas nuestras modificaciones, que luego podemos aplicar a todos nuestros gráficos. También existen temas prediseñados que modifican varios parámetros a la vez. Estos se introducen con el comando theme_ donde las opciones son muchas, en particular a mí me gusta la opción <code>theme_pubr</code> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> del paquete <em>ggpubr</em>. Podemos combinar todo en un objeto, por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'ggpubr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plyr':

    mutate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>THEME <span class="ot">&lt;-</span><span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">5</span>),</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span> , <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="co"># recuadro de la leyenda</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Luego podemos incorporarlo al final de los gráficos, así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>G1 <span class="sc">+</span> THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span> THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-93-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fuentes" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="fuentes"><span class="header-section-number">4.5.3</span> Fuentes</h3>
<p>Dentro de la opción <em>text</em>, podemos elegir la fuente de nuestro gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">...theme</span>(</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Las fuentes disponibles en windows no son muchas: “Arial”, “Times New Roman”, “Calibri”, “Courier New”, “Verdana”. Varían un poco de acuerdo a nuestro sistema operativo. Con el paquete <em>extrafont</em> podemos incorporar bastantes más.</p>
<p>Para chequear las fuentes disponibles en windows ejecutamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(grDevices<span class="sc">::</span><span class="fu">windowsFonts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "serif" "sans"  "mono" </code></pre>
</div>
</div>
<p>Para agregar en R las que tengamos en nuestro sistema podemos correr <strong>font_import()</strong>, luego cargarlas con <em>loadfonts()</em> y ver la lista con <em>fonts()</em> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>()</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fonts</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Algo muy importante, es que al momento de exportar como pdf nuestras imágenes, la fuentes tienen que estar embebidas para que las pueda leer cualquier lector de archivos pdf. Por suerte las nuevas versiones de <em>ggsave()</em> incluyen una opción que realiza esto de manera muy simple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"mono"</span>, <span class="at">size =</span> <span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-97-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"G3.pdf"</span>, <span class="at">device =</span> cairo_pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="división-de-la-ventana-gráfica" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="división-de-la-ventana-gráfica"><span class="header-section-number">4.6</span> División de la ventana gráfica</h2>
<p>Esta es una herramienta muy útil que nos permite visualizar más de un gráfico a la vez en la ventana 4 de RStudio. Ya que esta ventana suele ser pequeña, es recomendable marcar en <em>Zoom</em> una vez creado el conjunto de gráficos para verlo externamente.</p>
<section id="layout" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="layout"><span class="header-section-number">4.6.1</span> layout</h3>
<p>Esta opción ya la vimos anteriormente para los gráficos de supuestos. Básicamente se debe especificar una matriz mediante el comando <code>matrix</code> cuya estructura básica es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="co">#cantidad de casilleros</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>       r,p) <span class="co"># distribución en filas y columnas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entonces para una matriz 2*2 será:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para una 3*4 será:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por lo tanto, el comando de división gráfica tendrá la forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>Gráfico <span class="dv">1</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>Gráfico <span class="dv">2</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>) <span class="co"># al cerrar volvemos a establecer una ventana única</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se deben incluir tantos gráficos como particiones creadas. Por ejemplo viendo dos gráficos creados anteriormente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 fila y 2 columnas</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD, <span class="at">response =</span> Pb, <span class="at">data =</span> HOJA)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(PS<span class="sc">~</span>ET, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),  <span class="at">data =</span> SEM_Alim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los parámetros <code>widths</code> y <code>heights</code> permite establecer uno más grande que el otro:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD, <span class="at">response =</span> Pb, <span class="at">data =</span> HOJA)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(PS<span class="sc">~</span>ET, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),  <span class="at">data =</span> SEM_Alim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="par" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="par"><span class="header-section-number">4.6.2</span> par</h3>
<p>La función <code>par</code> también nos permite dividir la ventana gráfica. Las opciones que ofrece son muchísimas, incluyendo opciones avanzadas del manejo de márgenes. Aquí solo la nombraremos brevemente, para obtener el mismo resultado mostrado anteriormente podemos hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># filas y columnas</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lineplot.CI</span>(<span class="at">x.factor =</span> SPAD, <span class="at">response =</span> Pb, <span class="at">data =</span> HOJA)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(PS<span class="sc">~</span>ET, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),  <span class="at">data =</span> SEM_Alim)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># volvemos a como estaba antes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tanto la función <code>layout</code> como <code>par</code> son compatibles con <em>Devices</em> para la exportación.</p>
</section>
<section id="grid.arrange" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="grid.arrange"><span class="header-section-number">4.6.3</span> grid.arrange</h3>
<p>Esta función se encuentra dentro del paquete <strong>gridExtra</strong> y nos permite subdividir la ventana gráfica en un entorno de ggplot2. Además, es enteramente compatible con <code>ggsave</code> para su exportación.</p>
<p>Su estructura general tiene la forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  Grafico1 <span class="sc">+</span> modificaciones,</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  Grafico2 <span class="sc">+</span> modificaciones,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  .....,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span> número de columnas,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow=</span> número de filas,  <span class="co"># en general con establecer el número de columnas es suficiente</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="co"># podemos modificar el ancho relativo de cada columna</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>) <span class="co"># lo mismo para las filas</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como los gráficos en ggplot suelen involucrar muchas líneas, es conveniente crear un objeto con cada gráfico a utilizar. Por ejemplo, podemos combinar los gráficos creados anteriormente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(G2, G3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para exportar estos gráficos, hay que reemplazar en el mismo comando <code>ggsave</code> por todo el arreglo con <code>grid.arrange</code>.</p>
</section>
<section id="patchwork" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="patchwork"><span class="header-section-number">4.6.4</span> patchwork</h3>
<p>El paquete <strong>patchwork</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> permite una opción muy versátil para la combinación de gráficos y división de la ventana gráfica. Su uso además es muy sencillo, ya que si ya creamos los gráficos y tenemos el paquete cargado, podemos unir gráficos simplemente sumándolos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="sc">+</span> G3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Existen diferentes combinaciones posibles, por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>(G2 <span class="sc">+</span> G3)<span class="sc">/</span> G1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dentro de este paquete se encuentra la función <code>wrap_plots</code> que acomoda correctamente los gráficos y alinea los ejes. Así podemos correr:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(G1, G2, G3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Podemos modificar la estructura del gráfico con la función <code>plot_layout</code> dentro de <code>wrap_plot</code>. Aquí podemos definir la estructura de filas y columnas, la posición de las leyendas (o agruparlas en algún sector). Por su parte, se pueden modificar e incluso automatizar anotaciones con <code>plot_annotation</code>. Por ejemplo modificando el agrupamiento anterior:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(G1 <span class="sc">+</span> G2 <span class="sc">+</span> G3 <span class="sc">+</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">byrow =</span> <span class="cn">NULL</span>,</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">guides =</span> <span class="st">'collect'</span>)) <span class="sc">+</span> <span class="co"># muestra las leyendas juntas</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>, <span class="co"># establecemos el tipo de enumeración</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_prefix =</span> <span class="st">'('</span>,</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_suffix =</span> <span class="st">')'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Veremos más adelante algunas otras posibilidades con este paquete. Para exportar los gráficos se procede de igual manera que con cualquier otro gráfico de ggplot mediante la función <code>ggsave</code>.</p>
<p>También si los gráficos estuvieran combinados con <strong>patchwork</strong> podemos incluir la cuestión estética a todos a la vez al final separando con el comando &amp;:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(G1 <span class="sc">+</span> G2 <span class="sc">+</span> G3 <span class="sc">+</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">guides =</span> <span class="st">'collect'</span>)) <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_prefix =</span> <span class="st">'('</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Si dos de los gráficos comparten el eje x (por ejemplo), puede ser de utilidad ocultar el título en uno de ellos, o incluso ocultar la escala en el eje. Esto se puede hacer de diferentes maneras, pero aquí les muestro una incluyendo el elemento vacío en el tema con <em>element_blank</em> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(G1 <span class="sc">+</span> THEME <span class="sc">+</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span> </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>          G2 <span class="sc">+</span> THEME <span class="sc">+</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">guides =</span> <span class="st">'collect'</span>)) <span class="sc">+</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>,</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_prefix =</span> <span class="st">'('</span>,</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_suffix =</span> <span class="st">')'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="actividad-6" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="actividad-6"><span class="header-section-number">4.7</span> Actividad 6</h2>
<p>Exporte los dos gráficos que realizó en las actividades 3 y 5 combinados en una sola figura de dos columnas y una fila, agregue etiquetas a cada uno, aplique colores y escalas a los ejes. Junte las leyendas en una sola.</p>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>
<section id="unidad-5.-otros-tipos-y-parámetros-gráficos" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Unidad 5. Otros tipos y parámetros gráficos</h1>
<section id="gráficos-de-área" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="gráficos-de-área"><span class="header-section-number">5.1</span> Gráficos de área</h2>
<p>Para trabajar en de aquí en adelante utilizaremos otra base de datos. La misma la armé en base a los datos de superficie cultivada, producción y rendimiento de soja en Argentina y el mundo (extraída de informes de la FAO<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>) desde 1960 hasta 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>soja <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"produccion_soja_2023.csv"</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividiremos la base de datos en dos</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>mundo <span class="ot">&lt;-</span> soja <span class="sc">%&gt;%</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Area <span class="sc">==</span> <span class="st">"World"</span>)</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>argentina <span class="ot">&lt;-</span> soja <span class="sc">%&gt;%</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Area <span class="sc">==</span> <span class="st">"Argentina"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En primer lugar introduciremos un nuevo geom: <code>geom_area</code>. Como su nombre lo indica, permite graficar superficies completas en base a una escala continua. En este caso usaremos como eje <em>x</em> los años, como si fueran continuos. Así por ejemplo podemos graficar la variación de la superficie cultivada a lo largo del tiempo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(argentina, <span class="fu">aes</span>(Year, Sup<span class="sc">/</span><span class="dv">1000000</span>))<span class="sc">+</span> <span class="co"># editamos la sup para no ver números tan grandes</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill=</span><span class="st">"cornflowerblue"</span>, <span class="at">col=</span><span class="st">"gray21"</span>) <span class="sc">+</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="at">by =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Superficie sembrada [millones de ha]"</span>) <span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ahora supongamos que queremos graficar al mismo tiempo la superficie de Argentina y la global. Una opción sería dividir la variable Sup entre las regiones por <em>fill</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(soja, <span class="fu">aes</span>(Year, Sup<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill=</span>Area))<span class="sc">+</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">col=</span><span class="st">"gray21"</span>) <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Superficie sembrada [millones de ha]"</span>) <span class="sc">+</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si bien parece funcionar, al incluir esta opción geom_area apila los datos de una región con la otra. Por lo tanto, lo que vamos a hacer es superponer dos gráficos de área al mismo tiempo. Para ello introduciremos una nueva idea que es la de utilizar dos bases de datos diferentes en el mismo gráfico. Cuando creamos nuestro gráfico (ggplot(aes(…))) los <em>geom</em> que introduzcamos luego “heredan” tanto la base de datos como la estructura x-y determinada por aes que acompaña a ggplot. Si nuestro nuevo <em>geom</em> requiere una diferente, debemos expresamente introducirla. Finalmente, como la inclusión de nuevos <em>geom</em> no incorpora una leyenda, con la función <em>annotate</em> podemos introducir texto en algún lugar específico para clarificar qué significa cada área. También es posible introducir segmentos, flechas y otros elementos con esta función. Veamos cómo quedaría:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mundo, <span class="fu">aes</span>(Year, Sup<span class="sc">/</span><span class="dv">1000000</span>))<span class="sc">+</span> <span class="co"># aes principal</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill=</span><span class="st">"burlywood3"</span>, <span class="at">col=</span><span class="st">"gray21"</span>) <span class="sc">+</span> <span class="co"># primer área, es la que va al fondo</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Superficie sembrada [millones de ha]"</span>) <span class="sc">+</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> argentina, <span class="fu">aes</span>(Year, Sup<span class="sc">/</span><span class="dv">1000000</span>), <span class="co"># segunda, aparece al frente</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">"cornflowerblue"</span>, <span class="at">col=</span><span class="st">"gray21"</span>)<span class="sc">+</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">2008</span>, <span class="at">y=</span> <span class="dv">8</span>, <span class="at">label =</span> <span class="st">"Argentina"</span>, <span class="co"># agregamos texto en un lugar específico</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">size=</span><span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1990</span>, <span class="at">y=</span> <span class="dv">35</span>, <span class="at">label =</span> <span class="st">"Mundo"</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Entonces ahora nos queda un idea mucho mejor de cómo a crecido la superficie sembrada de Argentina respecto a la del resto del mundo.</p>
<p>Aquí hemos expuesto otra de las funcionalidades que nos facilita ggplot2: introducir más de un geom a la vez. Este puede ser del mismo tipo o diferente, como veremos a continuación.</p>
</section>
<section id="combinando-gráficos-de-distinto-tipo" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="combinando-gráficos-de-distinto-tipo"><span class="header-section-number">5.2</span> Combinando gráficos de distinto tipo</h2>
<p>También puede resultarnos de utilidad combinar gráficos de dos tipos diferentes. Esta opción es muy útil y sencilla de utilizar, sin embargo hay un par de condiciones a cumplir:</p>
<ul>
<li>el eje x debe ser el mismo.</li>
<li>el eje y también debe ser el mismo, o al menos ser “compatible” en escala (podría introducirse un eje secundario, pero excede al contenido de este taller).</li>
</ul>
<p>Una vez cumplidas estas condiciones, es solo cuestión de usar nuestra creatividad para crear el mejor gráfico. Supongamos como ejemplo que queremos comparar el rendimiento de la soja en Argentina contra el promedio mundial. Podemos hacer un gráfico de columnas clasificando por región:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>soja <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Area=</span><span class="fu">fct_recode</span>(Area,</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Argentina"</span><span class="ot">=</span><span class="st">"Argentine"</span>, <span class="co"># modificamos los factores al español</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Mundo"</span> <span class="ot">=</span><span class="st">"World"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, Yield<span class="sc">/</span><span class="dv">1000</span>, <span class="at">fill=</span>Area))<span class="sc">+</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by =</span> .<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Rendimiento [Tn/ha]"</span>)<span class="sc">+</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>  THEME <span class="sc">+</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">85</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como vemos, de esta manera nos quedan demasiadas columnas y es muy difícil tener una idea clara del patrón. En cambio vamos a colocar el rendimiento global como puntos unidos por una línea. Para ello utilizaremos las bases de datos argentina y mundo. Además vemos que las comas del eje Y aparecen como puntos, lo modificaremos al formato del español:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(argentina, <span class="fu">aes</span>(Year, Yield<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> <span class="co"># base de datos de argentina</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"cornflowerblue"</span>) <span class="sc">+</span>  <span class="co"># creamos las columnas</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by =</span> .<span class="dv">5</span>),</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">decimal.mark =</span> <span class="st">","</span>, <span class="co"># cambio . por ,</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">scientific =</span> <span class="cn">FALSE</span>))<span class="sc">+</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Rendimiento [Tn/ha]"</span>)<span class="sc">+</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span> mundo, <span class="fu">aes</span>(Year, Yield<span class="sc">/</span><span class="dv">1000</span>), <span class="co"># segundo geom, del mundo</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span> mundo, <span class="fu">aes</span>(Year, Yield<span class="sc">/</span><span class="dv">1000</span>), <span class="co"># tercer geom, de nuevo hay que especificar</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1990</span>, <span class="at">y=</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="st">"Argentina"</span>, <span class="at">col=</span><span class="st">"cornflowerblue"</span>, <span class="at">size=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1965</span>, <span class="at">y=</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="st">"Mundo"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ahora nos resulta mucho más fácil diferenciar en qué años (o períodos) el rendimiento fue mayor en Argentina que el promedio global.</p>
<section id="eje-secundario" class="level4" data-number="5.2.0.1">
<h4 data-number="5.2.0.1" class="anchored" data-anchor-id="eje-secundario"><span class="header-section-number">5.2.0.1</span> Eje secundario</h4>
<p>Si bien el uso de gráficos con ejes secundarios no fue planteado por el creador de ggplot2 por no considerarlo útil (idea que comparto), se puede incorporar mediante el parámetro <em>sec.axis</em> dentro de <em>scale_y_continuos</em> . Es importante destacar que este eje secundario se debe plantear como una transformación del eje primario. Esto limita fuertemente su uso, y en este curso simplemente aproximaremos una forma de hacerlo para ilustrar la segunda variable de una forma “aproximada”.</p>
<p>Supongamos que queremos graficar, siguiendo con nuestra base de datos, el rendimiento y la producción de soja en Argentina a lo largo del tiempo, en el mismo gráfico. Tomaremos como eje primario el de rendimiento, y secundario el de producción. Como un eje tiene que se una proporción del otro, creamos una nueva variable que nos indique la relación entre ellos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>argentina <span class="ot">&lt;-</span> argentina <span class="sc">%&gt;%</span> </span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Relacion =</span> Production<span class="sc">/</span>(Yield<span class="sc">/</span><span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y luego utilizaremos el valor máximo de estar relación para graficar y que ambas variables se “observen” en una escala similar. Luego deberemos realizar una conversión de la escala a poner en el eje secundario siguiendo un patrón similar. Como vamos a usar la relación máxima entre rendimiento y producción, el valor graficado será aproximado ya que cada año dicha relación será diferente. Sin embargo, veremos que la aproximación es bastante buena y sirve de forma representativa.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(argentina, <span class="fu">aes</span>(<span class="at">x=</span>Year))<span class="sc">+</span> <span class="co"># especificamos el eje x</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>Yield<span class="sc">/</span><span class="dv">1000</span>),  <span class="co"># luego en cada geom el eje y</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"darkolivegreen2"</span>) <span class="sc">+</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.5</span>),</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by =</span> .<span class="dv">5</span>), </span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sec.axis =</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="fu">max</span>(argentina<span class="sc">$</span>Relacion)<span class="sc">/</span><span class="dv">1000000</span>, <span class="co">#la relación de los ejes  </span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name=</span><span class="st">"Producción [millones de Tn]"</span>, <span class="co"># título</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">65</span>, <span class="at">by=</span><span class="dv">5</span>)))<span class="sc">+</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2023</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Rendimiento [Tn/ha]"</span>)<span class="sc">+</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>Production<span class="sc">/</span><span class="fu">max</span>(Relacion)), </span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="st">"blue3"</span>)<span class="sc">+</span> </span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Production<span class="sc">/</span><span class="fu">max</span>(Relacion)), </span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="st">"blue3"</span>, <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1990</span>, <span class="at">y=</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="st">"Rendimiento"</span>, <span class="at">col=</span><span class="st">"darkolivegreen4"</span>, <span class="at">size=</span><span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">2010</span>, <span class="at">y=</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="st">"Producción"</span>, <span class="at">col=</span><span class="st">"blue3"</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pivoteando-pivoting" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="pivoteando-pivoting"><span class="header-section-number">5.3</span> Pivoteando (pivoting)</h2>
<p>La última funcionalidad que veremos en este taller es el uso de <code>pivot_longer</code> y <code>pivot_wider</code>. Estas dos funciones tienen usos opuestos y veremos de a una cómo se usan, ya que nos permite transformar completamente la estructura de la base de datos, a partir de intercambiar columnas por filas (o viceversa).</p>
<section id="pivot_longer" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="pivot_longer"><span class="header-section-number">5.3.1</span> pivot_longer</h3>
<p>Nos permite agrupar diferentes variables (que tengamos en varias columnas) en una que contenga el nombre de la categoría (que antes era el nombre de una columna) y otra que contenga el valor numérico que corresponde a cada una. Nada mejor para ilustrarlo que un ejemplo. Recordemos nuestra base de datos <em>soja</em> que tenía esta estructura inicial:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(soja)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Area      Element         Year   Sup Production Yield
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Argentina Area harvested  1961   980        957   977
2 Argentina Area harvested  1962  9649      11220  1163
3 Argentina Area harvested  1963 19302      18920   980
4 Argentina Area harvested  1964 12220      14000  1146
5 Argentina Area harvested  1965 16422      17000  1035
6 Argentina Area harvested  1966 15689      18200  1160</code></pre>
</div>
</div>
<p>Supongamos ahora que queremos crear una columna que contenga en sus filas el tipo de parámetro que estamos midiendo (superficie, producción o rendimiento) y otra que contenga el valor del parámetro correspondiente. La estructura básica de <code>pivot_longer</code> es la siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">variable_1</span><span class="st">`</span>, <span class="st">`</span><span class="at">variable_2</span><span class="st">`</span>, ... , <span class="st">`</span><span class="at">variable_n</span><span class="st">`</span>), <span class="co"># variables a combinar</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">names_to =</span> <span class="st">"Variables"</span>, <span class="co"># el titulo de la nueva columna con las variables</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">values_to =</span> <span class="st">"Valor"</span>) <span class="co"># el título de la nueva columna con el valor numérico</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notar que el nombre de las variables se debe introducir entre tildes invertidas (`). En nuestro caso de ejemplo será:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>soja <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Sup</span><span class="st">`</span>, <span class="st">`</span><span class="at">Yield</span><span class="st">`</span>, <span class="st">`</span><span class="at">Production</span><span class="st">`</span>),</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">names_to =</span>  <span class="st">"Variables"</span>,</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 378 × 5
   Area      Element         Year Variables  Valor
   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 Argentina Area harvested  1961 Sup          980
 2 Argentina Area harvested  1961 Yield        977
 3 Argentina Area harvested  1961 Production   957
 4 Argentina Area harvested  1962 Sup         9649
 5 Argentina Area harvested  1962 Yield       1163
 6 Argentina Area harvested  1962 Production 11220
 7 Argentina Area harvested  1963 Sup        19302
 8 Argentina Area harvested  1963 Yield        980
 9 Argentina Area harvested  1963 Production 18920
10 Argentina Area harvested  1964 Sup        12220
# ℹ 368 more rows</code></pre>
</div>
</div>
</section>
<section id="pivot_wider" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="pivot_wider"><span class="header-section-number">5.3.2</span> pivot_wider</h3>
<p>La función <code>pivot_wider</code> hace exactamente lo contrario que <code>pivot_longer</code>, nos permite a partir de una columna con varios niveles de un factor, crear múltiples columnas (una para cada nivel del factor). Para utilizarla, cada fila que tengamos tiene que ser única (es decir, lo elementos que no son variables respuestas no pueden ser los mismos entre dos filas) para que no se genere confusión. La estructura general es la siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="co"># variable a dividir</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">values_from =</span> Valor) <span class="co"># variable respuesta numérica a repartir</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entonces, a modo de ejemplo, supongamos que queremos comparar como se ha incrementado la producción de soja en Argentina y el mundo desde 1961 hasta 2023. Para ello podemos primero seleccionar las variables de interés (solo nos interesa la producción), después filtrar los años de interés y crear nuevas columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>soja <span class="sc">%&gt;%</span> <span class="fu">select</span>(Area, Year, Production) <span class="sc">%&gt;%</span> <span class="co"># seleccionamos</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year<span class="sc">==</span><span class="dv">1961</span> <span class="sc">|</span> Year<span class="sc">==</span><span class="dv">2023</span>) <span class="sc">%&gt;%</span>  <span class="co"># filtramos</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span>  Year, <span class="at">values_from =</span> Production) <span class="sc">%&gt;%</span> <span class="co"># repartimos en columnas</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prop=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">2023</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">1961</span><span class="st">`</span>, <span class="dv">0</span>)) <span class="co"># transformamos con las variables entre ` `</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Area        `1961`    `2023`  Prop
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Argentina      957  25044978 26170
2 World     26883158 371173609    14</code></pre>
</div>
</div>
<p>Podemos ver como en Argentina en el último medio siglo se incrementó la producción 26170 veces, mientras que a nivel global 1381 veces.</p>
<p>Estas funciones tienen diferentes usos. Como vimos, <code>pivot_wider</code> puede servirnos para convertir variables y comparar niveles de un factor. <code>pivot_longer</code> puede servir tanto para corregir bases mal armadas como para generar nuevos criterios de clasificación que pueden ser útiles en algunos gráficos.</p>
<p>Por ejemplo final, supongamos que queremos ver en un mismo gráfico qué porcentaje de la producción global y de la superficie global sembrada representa Argentina. Para ello vamos a:</p>
<ul>
<li>seleccionar las columnas de interés</li>
<li>unir producción y superficie en una única columna (<code>pivot_longer</code>)</li>
<li>dividir Argentina y Mundo en dos columnas (<code>pivot_wider</code>)</li>
<li>calcular la proporción que representa Argentina del global y con ella el porcentaje</li>
<li>graficar aplicando como criterio de clasificación del color la columna que especifica si se trata de producción o superficie.</li>
</ul>
<p>Quedaría de la siguiente manera:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>soja <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Area, Year, Sup, Production)<span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Sup</span><span class="st">`</span>, <span class="st">`</span><span class="at">Production</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Area, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> Argentina<span class="sc">/</span>World,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">porc =</span> prop<span class="sc">*</span><span class="dv">100</span>  <span class="co"># notar que podemos usar la variable recién creada</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, porc, <span class="at">col=</span>variable))<span class="sc">+</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>),<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="at">by =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1960</span>,<span class="dv">2025</span>, <span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Años"</span>,</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Porcentaje del global"</span>)<span class="sc">+</span></span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"Sup"</span><span class="ot">=</span> <span class="st">"blue4"</span>,<span class="st">"Production"</span><span class="ot">=</span><span class="st">"red"</span>), <span class="at">guide=</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">2007</span>, <span class="at">y=</span><span class="dv">10</span>, <span class="at">label=</span><span class="st">"Superficie</span><span class="sc">\n</span><span class="st">cultivada"</span>, <span class="at">col=</span><span class="st">"blue4"</span>, <span class="at">size=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1995</span>, <span class="at">y=</span><span class="dv">18</span>, <span class="at">label=</span><span class="st">"Producción"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="gráficos-de-biplot-para-análisis-multivariado" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="gráficos-de-biplot-para-análisis-multivariado"><span class="header-section-number">5.4</span> Gráficos de biplot para análisis multivariado</h2>
<p>Esta sección tiene por objetivo mostrar que el conocimiento de los gráficos con ggplot2 sobrepasan al uso individual de este paquete, sino que hay mucho otros que se basan en él para generar gráficos. Un ejemplo de ello es el paquete <em>factoextra</em> para gráficos multivariados.</p>
<p>Vamos a desarrollar un ejemplo donde armamos un biplot a partir de un análisis de componentes principales (PCA). Vamos a retomar a la base de datos ALIM, y haremos un PCA comparando la concentración de distintos metales en los órganos, su peso seco y verdor. Para ello ejecutamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra);<span class="fu">library</span>(FactoMineR);<span class="fu">library</span>(ggrepel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'factoextra' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'factoextra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:agricolae':

    hcut</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'FactoMineR' was built under R version 4.4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>res.pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(ALIM[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">scale.unit =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-128-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Una vez creado el objeto de resultado de nuestro PCA, vamos a realizar un gráfico de biplot con la función <strong>fviz_pca_biplot</strong> de <em>factoextra</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>BIPLOT <span class="ot">&lt;-</span> <span class="fu">fviz_pca_biplot</span>(res.pca, </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.ind =</span> <span class="st">"point"</span>,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.var =</span> <span class="st">"deeppink4"</span>, </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.ind =</span> <span class="st">"black"</span>,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">labelsize=</span><span class="dv">5</span>,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">axes.linetype =</span> <span class="st">"blank"</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha.var=</span><span class="fl">0.5</span>,</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="cn">NULL</span>) ; BIPLOT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ahora vamos a realizar algunas modificaciones estéticas, y a incluir una clasificación por color según el órgano de el que se trate. Para ello vamos a crear un objeto nuevo con los porcentajes de explicación de cada eje:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>VARIANCE <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">get_eigenvalue</span>(res.pca)[,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>BIPLOT <span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> ALIM<span class="sc">$</span>Organo),<span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">col =</span> <span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">col =</span> <span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"PC 1 ("</span>, VARIANCE[[<span class="dv">1</span>]], <span class="st">"%)"</span>),</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"PC 2 ("</span>, VARIANCE[[<span class="dv">2</span>]], <span class="st">"%)"</span>),</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"Órgano"</span>) <span class="sc">+</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">40</span>, <span class="at">by =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.5</span>,<span class="fl">5.5</span>), </span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">9</span>,<span class="dv">9</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>  THEME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="curso_R_2025_q_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div style="text-align: right;">
<p><a href="../">Volver al inicio</a></p>
</div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Para más información del paquete <em>ggpubr</em> dirigirse a https://rpkgs.datanovia.com/ggpubr/ . Es un paquete muy interesante orientado a publicaciones usando ggplot2.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Para más información acerca del uso de <strong>patchwork</strong> recomiendo la página https://patchwork.data-imaginist.com/index.html.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>FAOSTATS. https://www.fao.org/faostat/en/#data/QCL<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>